Appendix
Answers to Review Questions
Chapter 1: System Architecture (Domain 101)
1. C. SATA disks are addressed as /dev/sdX, just like a SCSI disk. /dev/hdX is a traditional ATA disk. The other options do not exist.

2. B. Current interrupt (IRQ) assignments are contained in the file /proc/interrupts. Therefore, viewing the contents of the file with a command such as cat will work. There is no view command, thus making answer A incorrect. Likewise, there is no /dev/irq file, thereby making answers C and D incorrect.

3. C. The /dev/fd0 interface is typically the first floppy disk in a Linux system. There is no /dev/hd0 or /dev/flop0, thereby making answers A and B incorrect. While there is a /dev/sda interface, that will be the first SCSI or SATA disk within the system.

4. D. Configuration files for udev are found in /etc/udev, which makes answer D correct. The other options do not exist.

5. A. The modprobe command loads the module and its dependencies, if applicable. The lsmod command is used to list currently loaded modules, making answer B incorrect. The insmod command will load a given module but not its dependencies. Answer D, rmmod, is used to remove a module from memory.

6. B. The lsusb command is used to obtain a basic list of USB devices on a system. The other commands are not valid. In the case of answer D, the ls command is valid, but there is no –usb option.

7. D. The /etc/hotplug/usb directory contains scripts that run when a given device is plugged in. The other directories don’t exist, so those options are not correct for this ­question.

8. C. The keyword single given on the Linux kernel command line will boot the system into single-user mode. The other options are not valid.

9. A. The Shift key, if pressed when control has first been handed to GRUB, will cause the GRUB menu to be displayed.

10. D. The dmesg command displays the contents of the kernel ring buffer. On many Linux distributions, this log is also saved to /var/log/dmesg. The other options shown for this question are not valid commands.

11. C. Runlevel 1, sometimes displayed as runlevel s or S, is single-user mode in which many services are not started. Runlevel 5 and Runlevel 6 are used for other purposes and runlevel SU is not a valid option.

12. D. Scripts are stored in /etc/init.d on a system using SysVinit. You may sometimes find these linked from /etc/rc.d/init.d as well. The other options are not valid for this question.

13. A. The init command can be used to access different runlevels. Runlevel 6 is used for rebooting the system. Answer B will shut down the system entirely, not reboot it. Answer C will place the system into single-user mode. Answer D is not a valid option.

14. C. The telinit command can be used to refresh the system after changes have been made to /etc/inittab. Notably, answer B will reboot the system, but that was not an option given the question asked. Answers A and D are not valid commands.

15. D. The runlevel command displays the current runlevel for a system. Answer B is not a valid option for the init command, and adding sudo in front of the init command makes no difference. Answer A is not a valid command.

16. C. Unit configuration files are stored in /lib/systemd/system. The other directory options for this question are not relevant or do not exist by default. Operating system files are typically stored in /usr/lib/system and those related to systemd can be found in the /usr/lib hieararchy.

17. A. The listing shows a symbolic linked file located in the current directory, linked to .configs/fetchmail/.fetchmailrc. The file is owned by the root user and root group, and it was created on July 8, 2014.

18. B. The systemctl command is used to work with services and targets. The list-units command is used to list targets. The other commands are not used for this purpose or do not exist with the required option.

19. C. The -nn option displays both numbers and device names, thus making answer C correct. The -n option (answer B) displays only numbers. The other two options do not exist.

20. D. The lsmod command is used to list currently loaded kernel modules, thereby making answer D correct for this question. The insmod command (answer A) is used to load modules. Answer C is a valid command but not a valid option for that command, while answer B does not exist.

21. C. The –show-depends option shows the modules that depend on the specified module. The options shown in the other answers do not exist.

22. B. The wall command is used to send a message to all users, thereby making answer B correct. The cat command is used as a means to concatenate or view files, while tee is used to send output to standard output and a file. Finally, ssh is the secure shell client command, and it is not used for the purpose specified.

23. B. Checking to ensure that the disk is detected in the BIOS is a good first step in troubleshooting. Answer A, unplugging the disk, won’t help it to be detected. Restarting the web server won’t help detect the disk, and the disk-detect command does not exist.

24. D. The /proc/bus/usb directory contains information about USB devices. The other directories are not valid for this purpose.

25. B. The root=/dev/sda2 option will cause the given kernel to load /dev/sda2 for its root partition. The rootpartition option is not valid, and the format of the root={hd0,3} is not valid in this context.

26. C. You begin an editing session with an E when the boot option is highlighted. You can then make changes, and when finished, press B to boot the system.

27. A. The ls command from within the grub > prompt will show the available partitions in a format such as (hd0,1).

28. D. The file /var/log/dmesg will typically contain historical messages from the current booting of the system. On some distributions of Linux, this information is also in /var/log/boot.log.

29. C. Out of the options given, the systemctl status command is the most appropriate. The telinit and sysctl commands are not used for this purpose. Likewise, the –ls option is not valid for systemctl.

30. B. The isolate option is used to move the system into the target specified, thereby making option B the correct one. The other options do not exist.

31. A. The initctl reload command causes Upstart to reread its configuration files.

32. B. The –list option will show all services on a system along with their status for each runlevel.

33. C. USB devices are generally considered to be hotplug devices. Hotplug devices describe those devices that can be inserted and removed while the system is “hot,” or powered on, whereas coldplug devices are those that must be inserted and removed when the system is powered off.

34. D. The root partition is mounted after device initialization. System services, including multi-user mode, start after the root partition is mounted. The other two options, A and C, take place prior to the kernel initializing device drivers.

35. A. With cable select, ATA drives will be detected in the order in which they are plugged in on the cable from the motherboard. It’s likely that the drives need to be swapped physically on the cable.

36. B. The umount command is used to unmount drives within a running system. The other commands do not exist.

37. D. The ESP is typically mounted at /boot/efi.

38. A. The mount command is used to mount drives in Linux. The source and destination mount points are expected as arguments. Drive partitions begin at the number 1, making the first partition number 1.

39. D. Of the options presented, running dmesg is a common way to find out the location to which the kernel has assigned the drive. Rebooting the system is not a good option, though it would work. There is no such thing as /var/log/usb.log, and the location of the drive may change regardless of port, depending on how the drive may be detected in the system.

40. B. From these options, only B will shut down the system immediately. Answer A will cancel a shutdown.

41. C. The ExecStart option indicates the command to be executed on startup of a systemd service.

42. D. The systemctl get-default command will show the default target. The other commands and options are not valid.

43. A. The enable option configures the service to start on boot. The start option, answer D, is used to start a service immediately. The other options are not valid for this command.

44. C. The /proc filesystem contains information about currently running processes and additional information about the kernel and current boot of the system.

45. C. The -t option to lsusb will print output in a tree-like format so that you can see which devices are connected to which bus. The other arguments to lsusb are not valid, and the usblist command is not real.

46. A. SCSI supports 7 to 15 devices per bus, depending on the type of SCSI.

47. D. If a working device does not appear in lsmod, it typically means that the kernel has a driver already loaded by virtue of being compiled into the kernel itself rather than loaded through a module. The use of systemd (answer A) or initramfs (answer B) has no effect.

48. C. The -w option causes the module to wait until it’s no longer needed prior to unloading. The -f option forces immediate removal and should be used with caution. The other options are not valid for rmmod.

Chapter 2: Linux Installation and Package Management(Domain 102)
1. D. The partition containing /var should be the largest for a mail server because mail spools are stored within this hierarchy. The /etc/ hierarchy is usually small, as is /usr/bin. The /mail directory does not exist by default.

2. C. The rootnoverify option is used to specify a non-Linux kernel, one that GRUB should not attempt to load. The initrd option is used for specifying the initial RAM disk, thereby making option A incorrect. The remaining options, B and D, are not valid options for GRUB.

3. C. The noexec option will prevent programs that reside on the partition from being executed. The noexec option is used frequently for mounting the /tmp partition.

4. A. The update-grub command sends its output to STDOUT. Therefore, you must redirect using > and send that output to the correct file. The other options are not valid for this purpose. Answers C and D are not valid commands while answer B contains invalid options and an invalid location for the destination file.

5. B. MBR-based disks can be partitioned with up to four primary partitions, one of which can be further partitioned or extended into logical partitions.

6. D. The ldconfig command updates the current shared library cache and list. ldconfig reads /etc/ld.so.conf and incorporates any changes found within it. The other commands listed as options for this question do not exist.

7. B. The upgrade option for apt-get will upgrade the system to the latest version of software for packages already installed. The apt-update command does not exist nor does the -U option to dpkg. The apt-cache command is used to work with the package cache.

8. C. The yum install command will install a given package. The update option will update a package. The other options listed do not exist.

9. C. Root’s home directory is /root on a Linux system. While the /home directory does exist, there is no root or su user within that hierarchy by default. The / directory is the root of the filesystem but not root’s home directory.

10. A. rpm2cpio sends its output to STDOUT by default, and therefore that output needs to be redirected to a file in most cases.

11. B. 0x82 is Linux swap while 0x83 is Linux. NTFS is 0x07 and FAT32 is 0.0c.

12. B. The /usr hierarchy contains many of the programs that run on a Linux system. Other notable directories for programs are /bin and /sbin.

13. B. GRUB begins its count at 0, and in this scenario there are two operating systems. Therefore, because Linux is first in the configuration file, its number would be 0, which is then sent to the default= option.

14. A. The /etc/default/grub file can be used for this purpose. You may also edit /boot/grub/grub.cfg, but this was not an option given for this question.

15. B. The deplist option displays the dependencies for the given package. The list option displays information about a specific package, while the other two options are not valid.

16. A. The -ivh options will install a file using rpm, displaying both verbose output and hash marks for progress. The other options presented do not exist or do not accomplish the specified task.

17. B. The export command is used to set environment variables in Bash. The other commands are not valid for this purpose.

18. D. The yumdownloader utility will download an RPM package but not install it. The yumdownloader utility is part of the yum-utils package. The other options listed for this question do not exist.

19. A. The apt-cache command is used to work with the package cache, and the search option is used to search the cache for the supplied argument, in this case zsh. The apt-get command is used to work with packages themselves, while the apt-search command does not exist.

20. C. The GRUB_DEFAULT option, when in the /etc/default/grub file, is used to configure the operating system that will boot by default. The other options do not exist in this context.

21. A. The ro option, which is the default for GRUB, will initially mount the root partition as read-only and then remount as read-write.

22. D. Configuration files related to the repositories for YUM are located in /etc/yum.repos.d. Of the other options, /etc/yum.conf is a file and not a directory, and the other directories do not exist.

23. A. The -V or –verify option will check the files in a given package against versions (or checksums) in the package database. If no files have been altered, then no output is produced. Note that output may be produced for files that are changed during installation or for other reasons. Note also the use of an uppercase V for this option as opposed to the lowercase v for verbose.

24. C. The -o option can be used to specify a destination file to which output will be sent instead of STDOUT. The other options listed in this question do not exist.

25. A. The menu.lst and grub.conf files are used in GRUB Legacy, that is, prior to GRUB 2. This therefore makes answer B incorrect.

26. D. The ldd command will list the libraries on which the command’s argument depends.

27. B. Swap space is used when there is insufficient RAM on a system.

28. B. The /etc/lib directory is not typically associated with library files and does not typically exist on a Linux system unless manually created. The other options either contain system libraries or can be used for that purpose.

29. C. The apt-get update command will cause the package cache to be updated by retrieving the latest package list from the package sources. There is no cache-update option or update option to apt-cache. The upgrade option is used to update the system’s packages and not the cache.

30. C. The file sources.list located in /etc/apt contains the list of repositories for Debian packages. The other file locations do not exist by default.

31. A. The /boot partition will typically be much less than 500 MB but should not be undersized. The used space within /boot will increase as more kernels are added such as during an upgrade process.

32. B. The pvcreate command initializes a physical partition for future use as a logical volume with LVM.

33. D. The grub-install command is used to install GRUB onto a disk and the second SATA disk would be /dev/sdb, therefore making answer D the correct option. You can use grub-install on different disks in order to provide an alternate or backup boot option.

34. A. The dpkg-reconfigure program will cause an already-installed package to be reconfigured or changed. The -r option for dpkg is for removal of a package, thus making answer B incorrect. There is no reconf option for dpkg or reinstall option for apt-get.

35. C. The lvcreate command is used to create logical volumes with LVM. The pvcreate command initializes physical volumes prior to creating logical volumes. The command in the other two options for this question do not exist.

36. A. Physical volumes are initialized first, followed by volume group creation, and then logical volume creation.

37. D. aptitude provides the terminal-based interface rather than the standard command-line interface of the other tools listed in this question.

38. D. The -search option performs a search of various fields such as the package name and description.

39. B. The rpm -q kernel command will show the kernel version. You can also use uname -r for the same purpose.

40. C. The GRUB_DEFAULT option in /etc/default/grub will set the operating system to boot by default.

41. A. The exclude option can be used to exclude certain packages. The argument accepts wildcards, and therefore excluding all kernel* updates will create the desired behavior.

42. B. The partition type 0x83 should be created for a normal Linux partition. Type 82 is used for swap, while 84 is an OS/2 partition. There is no L type.

43. B. The grub-mkconfig command should be run after making a change to the /etc/default/grub file so that a new configuration file can be created with the changed option(s).

44. B. The -s option to dpkg searches for the given package and provides information about its current status on the system. The apt-cache command is not used for this purpose, and the -i option for dpkg installs a package. The apt-info command does not exist.

45. C. The lvmdiskscan command looks for physical volumes that have been initialized for use with LVM.

46. B. The –resolve option will download the dependencies of the package being downloaded. The other options shown within this question are not valid for the yumdownloader command.

47. A. The -i option to dpkg will install a previously downloaded package. The other commands don’t exist, and the -U option for dpkg does not exist.

48. D. GRUB Legacy begins counting at 0 and separates the disk letter and partition with a comma, therefore making 0,0 the first partition on the first disk. Answer A is not the first disk on the system and answers B and C contain nonexistent partitions or devices.

Chapter 3: GNU and Unix Commands (Domain 103)
1. B. The env command will print the current environment variables from Bash. The printenv command will also perform the same operation. The other commands listed in this question do not exist.

2. D. The set command can be used for a variety of purposes to change how the shell environment works. One such option is -C, which prevents output redirection such as that done with > from overwriting a file if the file already exists.

3. C. The man command displays documentation for the command given as the argument. The other options listed for this answer do not exist.

4. D. The uname command is used to print system information, and the -a option prints all information available to uname.

5. A. The g option, also known as global or greedy, will apply the matched operation to the entire line rather than just the first instance of the match. The other options apply as they would for a Perl Compatible Regular Expression.

6. C. The -l option provides the number of lines given as input. For example, wc -l /etc/passwd would print the number of lines in the /etc/passwd file. The other options given in this question are not valid for the wc command.

7. C. Both head and tail print 10 lines of output by default.

8. B. The -rf options to rm will recursively remove contents of a directory, including other directories. The -f option alone will not work in this case because of the additional directories. The other options given for rmdir do not exist.

9. D. The -type option causes find to limit its search to directories only, whereas the -name option limits the names of returned elements. Note the use of the wildcard due to the phrasing of the question. Also note the use of ./ to denote beginning the search in the current directory.

10. A. The cat command will display the contents of the file /etc/passwd and then pipe that output to the awk command. The awk command then parses its input, splitting along the specified separator for /etc/passwd, which is a colon (:). The output is then printed and piped to the sort command. The sort command in option B will not work because the cut command requires an argument. Likewise, the echo command in option C will only echo /etc/passwd to stdout. The split command can also be used to split input but does so on a fixed width manner which is generally not feasible when working with the passwd file as input. Also, the tr command is a typical companion to the awk command and helps to substitute the characters from awk output.

11. C. The -l option for ls produces long or listed output, and -t sorts by timestamp. The -r option reverses the order, and -a is needed to include hidden (dot) files, thus making answer C correct.

12. A. The timestamp of the file will change when touch is run on a file that already exists.

13. D. The -i option will cause both cp and mv to be interactive, that is, prompt before overwriting. The -f option will force the command to run while -r is recursive.

14. C. The tee command will send output both to stdout and to the specified file, thus making answer C correct. Option A will redirect output to the correct file but not to stdout simultaneously. The other answers will not work for this question. It should be noted that there is no specific formatting included with cat or tee. If formatting is needed for text processing, the fmt command can be used.

15. A. The -p option will cause mkdir to create additional levels of directories without error. Running mkdir without options will not work in this case. The -r and -f options to mkdir do not exist.

16. B. The -R option will copy directories recursively. Note that if the -i option is not enabled, the recursive copy will overwrite files in the destination. The -v option adds verbosity but does not cause any recursion, and the -Z option does not exist.

17. C. The file command can be used to determine which type of file is being used. This can be particularly helpful for files without extensions where you are unsure if you should view the contents of the file. Option A, grep, is used to look within files but would not be helpful in this case. The telnet and export commands are not used for this purpose.

18. C. The dd command is used to create disk images, among other things. In this case, the input file is /dev/sda1 and the output file is output.img. It’s also common to add the blocksize option by using the bs argument, such as bs=1M.

19. B. The cut command uses a tab as its default delimiter. This can be changed with the -d option. You might use the cut command in order to apply text filters to one or more files so that they can be further processed later. For example, you might cut certain fields and create new files that can be connected together using the join or paste commands. You can use the unexpand command if you need to convert spaces to tabs and the expand command to convert tabs to spaces. However, you can also change the delimiter that is used by cut.

20. A. The -z option will unzip the file while -x will extract from the tar archive, and -f is used to indicate the file on which to perform the aforementioned operations. It’s typical to add -v for verbose output as well.

21. D. The fg command will bring a command to the foreground if it has been backgrounded with either & or with the bg command. You might background a command or process so that it continues running after logout.

22. B. While the ps auwx command combined with grep will provide information on the running Apache instances, it will provide much more information than is required or useful for this problem. The pgrep command provides only the process IDs and therefore meets the criteria presented in the question.

23. D. The top command is used to monitor continuously things like CPU and memory usage, and the -p option monitors a single process. By using the run quotes with the pidof command, the process ID is provided as input to the -p option.

24. D. The free command displays overall memory usage for both RAM and swap and can be used to determine when additional memory might be needed.

25. A. You need to write the changes to the file; therefore, you’ll need :w. The addition of q will also quit. Note that you could use ZZ to write and quit as well. The dd command deletes a line whereas x deletes a single character.

26. D. The -n option changes the number of lines of output for both head and tail to the number specified. The other options listed in this question are not valid for head, and the -f option follows a file with tail as the file grows.

27. A. The uptime command shows basic information such as that described in the question along with the number of users logged into the system and the current time. The bash command is a shell environment, and the ls command will not display the required information.

28. D. The screen command starts a new terminal that can be disconnected and reconnected as needed. Processes running from within the screen session do not know that they are running in a screen session, and therefore this meets the criteria needed to satisfy this question. The fg or bg commands will not meet the criteria, and the kill command will stop a process.

29. C. The -9 option invokes SIGKILL, which will force the process to end. The -15 signal is the default, and the -f and -stop options do not exist. Certain commands may have been started with nohup, meaning that they are immune to hangups that might be issued with other signals. Note that you can kill a group of commands with the pkill command rather than individually with kill.

30. C. Within Bash, the number 1 represents stdout and 2 represents stderr. Redirecting both means combining them in the manner shown in option C.

31. B. The nice command, when run without arguments, will output the priority for the currently logged-in user, which is normally 0. The renice command can be used to change the priority of running processes. The other two commands shown as options for this question do not exist.

32. D. Within a regular expression, * represents zero or more characters, and in this case the problem doesn’t care whether a person is using /bin/bash or /usr/bin/zsh. Likewise, a . matches a single character, but in the case of bash and zsh we need to look at the first and optionally a second character, thus the ? making the second . optional. Finally, the $ anchors the pattern at the end of the string and is also key for this regular expression. The egrep command is equivalent to grep -e and fgrep is equivalent to grep -F, both of which are deprecated. For more information on regular expressions see regex(7).

33. A. The different levels of the manual are accessed by preceding the argument with the desired level. The other options, such as –list, do not exist in this context.

34. C. The o command opens a new line below the current cursor location. The a command begins an insert mode session at the character after the cursor, not the line. The i command begins an insert mode session at the current cursor location.

35. A. Sending -HUP as part of the kill command will restart a process. Of the other answers, -9 will kill the process completely. The other two answers do not exist as valid means to kill a process.

36. B. The history command will display your command history, including commands from the current session. You can specify how many lines of history to display, as shown in the answer for this question. Note that .bash_history will not show the current session’s history.

37. C. The jobs built-in command shows the list of jobs running in the background. Its output includes a job number and the status of the job.

38. B. The find command beginning with the path and then the -name argument will locate all of the files called .bash_history. The output from the find command should be piped to xargs, which can then build further commands from standard input. Note that this question and solution assume that all users use the Bash shell and are keeping history.

39. C. The tail command provides the end portion of the file given as an argument. Adding the -f option will cause the output to update as new lines are added to the file being tailed.

40. D. The nl command will prepend line numbers onto the file given as its argument. The output is then sent to stdout. Of the other answers, wc -l will print the number of lines in the file but not prepend those numbers onto each line, as was asked for in this question.

41. A. The xz command can compress and decompress files in a variety of formats, one of which is lzma.

42. A. The find command is used for this purpose. Adding -type f will limit the search to only files, and the -mtime option will limit to modification time in day format.

43. C. The mv command is used to move files, and *.txt will look for all files with a .txt extension. Note the fully qualified destination with a / preceding the name tmp.

44. D. The pwd command prints the current working directory. The cd command changes directory.

45. A. The file first needs to be sorted to group common zip codes together. After that, piping the output to uniq will display the unique zip codes, and the -c option provides a count.

46. A. Preceding the command with ! will search history and execute the specified command. For example, !vi will start your last vi session.

47. C. The killall command is used to terminate processes using their name.

48. C. The ? will search backward in a file within vi. The / is used for searching forward. The h key will move the cursor to the left one character, and the x key will delete a character.

Chapter 4: Devices, Linux Filesystems, and the Filesystem Hierarchy Standard (Domain 104)
1. A. The which command returns the full path to the given command, and it is useful for determining both whether a given command is available and the location from which the command will run.

2. A. The chgrp command can be used to change group ownership of a file. The order is chgrp <groupname> <target>.

3. C. The file is almost certainly a hard link to the original script. While ls won’t show this information, the stat command will show that it is a link and also show the inode to which the file is linked.

4. A. The -i option to df produces information on inodes across all filesystems. The ls -i option will produce inode listings but only for the current directory. The -i option is invalid for du, and dm does not exist as a command.

5. C. The -y option will attempt to repair automatically, essentially answering y, or yes, instead of prompting. Of the other options, only -V is valid and will produce verbose ­output.

6. D. The first step is to use fdisk to create one or more partitions, then format the partitions, and then mount the partitions for use. The fdisk command is used with various types of disks including MBR-based partitions.

7. B. The tune2fs command can be used for this purpose but should be used with care because it can result in data corruption.

8. B. The addition of journaling in ext3 increased filesystem reliability and performance.

9. C. The -S option displays output in a format such as u=rwx,g=rx,o=rx. The other options listed in this problem do not exist.

10. B. The -s option to ln creates a symbolic link or symlink.

11. C. The whereis command displays pertinent information about the command given as its argument. For example, entering whereis apache2 on a Debian system will show the binary location, configuration file location, and other relevant details.

12. A. The PRUNEPATHS option accepts a space-separated list of paths to remove from the results. The other options listed in this question do not exist.

13. D. The /srv hierarchy is used for data for server programs. The /etc hierarchy is configuration information, while /var is also used for data files but variable ones such as mail files. The /tmp directory is for temporary files.

14. C. The chmod command is used for this purpose, and the u+s option sets the sticky bit for the user on the specified target.

15. C. The -a option mounts all filesystems in /etc/fstab that are currently available. Of the other options listed, only the -f option is available and it is a shortcut to the “fake” option that does nothing except perform a dry run of the mount.

16. B. The mkswap command formats a swap partition. The fdisk command is used to create the partition itself but not format it. The other two options do not exist.

17. A. The tune2fs command displays a lot of information about filesystems including the number of times that the filesystem has been mounted.

18. A. The -g option displays progress of the dump. The other options listed do not exist.

19. D. The quotacheck command is used to update the quota file for the given filesystem. The quota -u command will display the current quota for a given user. The other commands do not exist.

20. A. The du command will report on disk usage in a recursive manner, unlike the other commands shown here.

21. C. The /etc/fstab file is used to store information about the filesystems to mount within the system.

22. D. The /media mount point is used for removable media. See https://wiki.linuxfoundation.org/en/FHS for more information on the FHS.

23. A. The /etc/mtab file contains currently mounted filesystems. Note that /etc/fstab contains filesystem information but not about which filesystems are currently mounted.

24. B. The -r option causes umount to attempt to remount in read-only mode. The -v option is verbose mode, and the -f option forces the operation. The -o option does not exist.

25. C. The 022 umask value will translate into 644 permissions on a new non-executable file.

26. B. The l within the listing indicates a symlink. There is no way to tell if a file or directory is temporary. A directory will display a d instead of an l. Symbolic links are not copies of files but rather are akin to shortcuts. Changes to the contents of the symlink change the source file as well.

27. B. The repquota command is used for this purpose, and the -a option will display information for all filesystems.

28. C. The updatedb command will update the database used by the locate command.

29. A. The type built-in command returns the location that the shell will use in order to run the given command. The find command cannot be used for this purpose, and the other commands do not exist.

30. B. The -R option will perform the change ownership in a recursive manner.

31. D. The proper order is the device (UUID or partition), followed by the directory to mount that device, followed by its type and options, and then the dump and fsck settings.

32. A. The blkid command will show partition UUIDs. You can also get this information with the lsblk -no UUID <partition> command. The other commands shown in this question do not accomplish the required task.

33. D. The xfs_info command is equivalent to xfs_growfs -n.

34. B. The mkfs.btrfs command is used to create btrfs filesystems and does not require the drive to be partitioned.

35. C. The usrquota option will enable user-level quotas on the given mount point. This is typically set within /etc/fstab.

36. A. The best option among these choices is to change the group to www-data and change the permissions such that the group can write into the directory. Option B should never be used because it enables world writing to the directory. The other options will not allow the web server group to write into the directory.

37. A. The tune2fs command is used for this purpose, and the -c option sets the mount count for the specified partition.

38. B. The parted command can be used to resize partitions in such a way. The mkfs command is not used for this purpose, and the other two options do not exist.

39. C. The VFAT filesystem is known as vfat to the mount command, and the other elements of the mount command are standard.

40. D. The c option in gdisk is used to change the partition name. The n option creates a new partition, the v option verifies the disk, and the b option creates a backup of GPT data to a file.

41. C. The -b option prints known bad blocks. The -f option is used to force the display of information, and the other options don’t exist.

42. B. The -A option checks all filesystems in /etc/fstab, while the -M option excludes the root filesystem. The fsck that will run will be dependent on the type of filesystem. For example, e2fsck will be executed for ext2 partitions.

43. B. The quotaon command signifies that quotas should be enabled for the given filesystem. This would imply that a quota file has already been created. Quotas can be edited with the edquota command.

44. C. The fsck option, which is represented as a number in the /etc/fstab file, sets the order in which the device is checked at boot time.

45. D. The -c option creates the files for the first time. The -f option is used to force checking, -u is used for user quotas, and -m is used to not attempt remounting as read-only.

46. C. The debugfs command can be used for this purpose. When opening with -c, the filesystem will be opened in catastrophic mode, meaning that it will be opened read-only and will not read inodes when opening.

47. D. The -inum option searches for files by their inode number. This can be useful when searching for the files involved in hard links.

48. C. The -R option sets the recursive option, which means that chgrp will traverse the given directory and perform the group ownership change operation throughout the ­specified ­hierarchy.

Chapter 5: Working with Shells, Scripting, and Data Management (Domain 105)
1. C. The source command is used to execute commands from a file. A typical use case is to create functions or variables that are then available for use within the current session. The other commands listed do not exist.

2. B. While it’s true that every user has a .bash_logout, the file exists in their home directory and therefore can be edited by the user. Thus, to ensure that the required command is executed at logout, the file /etc/bash.bash_logout must be used.

3. B. The env -u command will unset an environment variable for the current session. The unset command can also be used for this purpose.

4. A. The env command, when used as #!/usr/bin/env bash, will determine the location of the Bash interpreter automatically. This makes the resulting script more portable for systems where Bash may not be located in /bin/. You can use this command as a way to customize shell scripts for cross-platform use. Small scripts can be created for most of the commands in the book and those scripts can help automate many system administration tasks.

5. D. The SELECT command is used for this purpose, and the * selection retrieves all data. SELECT statements include the query part followed by the FROM keyword and then the data source, which in this case is a table called users.

6. B. The PS1 variable usually has its default set in /etc/profile and is used as the shell prompt. Users can customize the prompt to include hostname, working directory, and other elements.

7. A. The alias command is used for this purpose, and its format is name=value, thus making option A correct. The ln command cannot be used for this purpose because it will not accept command-line arguments for the target in such a format as shown in the options.

8. B. User-based configuration files are located in the order .bash_profile, .bash_login, and .profile. Only the first file found is executed and the others are ignored.

9. C. The $1 variable is automatically available within Bash scripts and represents the first command-line argument. The $0 variable is the script itself. The other variables listed in this question do not exist by default.

10. D. The fi construct is used to indicate the end of an if conditional within a Bash script. In many languages, if conditionals are scoped by braces such as { }, but in shell scripting, fi is used to denote the end of the condition.

11. B. The DELETE FROM statement deletes all of the data from the given table. Note that MySQL is typically case sensitive, thus creating the need to follow the same case for the virtualusers table object.

12. A. The DESC or DESCRIBE command is used to provide a description of the columns and column types for a table. Of the other commands shown as options, only SELECT is a valid SQL command, and it is used to retrieve data and not a description of the table itself.

13. B. The seq command is used to print a sequence of numbers in a variety of formats. The answer for this question provides a starting point (0), an increment (1), and the final number (5), thus resulting in six numbers being displayed as output.

14. B. The echo command is used to display its argument, regardless of whether the command is used inside a shell script or from the command line itself. The env command is used to display environment variables and therefore does not meet the need specified in the question. The var_dump command is used within PHP, and ls is used to display contents of directories.

15. A. The SUID bit enables the program to run as the user who owns the file regardless of who executes the program. Using SUID is typically not recommended for security reasons.

16. D. The exec command executes the script given as its argument and will then exit the shell. The source command does not exit the shell.

17. C. The double-ampersand sequence executes commands only if the previous command within the command line exited cleanly.

18. C. The read command awaits user input and places that input into the specified variable. The exec command is used to execute commands, and the other options are not valid for the purpose described.

19. A. Parentheses are used to denote a function, such as myFunction(). The parentheses are optional but are then followed by curly braces containing the commands to be executed when the function is called.

20. A. The ORDER BY clause is used for this purpose, and the ASC keyword needs to be added in order to make the display in ascending order.

21. C. The || sequence indicates an alternate command to run if the initial preceding command does not exit cleanly. The && sequence executes only when the preceding command exits cleanly, so it’s the opposite of what the question was asking.

22. C. The elif keyword is used to create an alternative execution path within a shell script. The other constructs such as else if and elsif are used in other languages.

23. C. The unalias command is used to remove a previously defined alias. The rm command will remove regular files but not aliases. The other commands do not exist.

24. D. You minimally need to be able to read the file being sourced; therefore, chmod 400 will correctly set the permissions. Any chmod that gives additional permissions is not necessary.

25. C. The for loop construct in this case will require the variable name LIST to be preceded with a dollar sign ($), thus making option C correct. The other options will not work for the purpose described.

26. A. An inner join is the default type of join performed by SQL when columns are joined in the manner specified. An outer join, whether left, right, or both, is used to return rows that are not in a particular table as well.

27. C. The -lt operator is used to test for “less than” conditions within a script. The other operators are not valid for use in a shell script.

28. B. The -e option checks to ensure that a file exists, and it is typically used in the context of a conditional within a shell script. The other options may work within shell scripts but are not tests for file existence.

29. C. The /etc/skel directory contains files to be copied to the user’s home directory. The other directories listed for this question do not exist by default.

30. A. The UPDATE statement uses the SET keyword to indicate the column or columns to change. The WHERE clause is optional.

31. D. The syntax begins with INSERT INTO<table>. This syntax is then followed optionally by the names of the columns to which values will be inserted, followed then by the VALUES keyword and finally the values to be inserted.

32. C. The –norc option causes Bash to execute without reading the /etc/bash.bashrc file or the local ~/.bashrc file. The other options listed do not exist as options for Bash.

33. A. Array creation in a shell script involves parentheses when used in this manner. You can also use square brackets to define individual elements, as in ARRAY[0] = "val1".

34. C. The -p option displays declare statements in a way that the commands are fully qualified and could then be used as input for another command, either through piping or redirection to a script.

35. A. The .bash_profile file, if it exists in your home directory, will be executed on login. Note that placing the function in /etc/profile would technically work, but then the function would be available to all users, which is not what the question is asking.

36. B. The readonly command displays the list of read-only variables that have been declared in the current session. The other commands listed for this question do not exist.

37. A. The only SQL statement that can utilize a GROUP BY clause is the SELECT statement. The other commands listed are valid but not for use with GROUP BY.

38. C. Square brackets are used to denote the beginning and end of the test portion of a while loop in a shell script. Other languages generally use parentheses for this purpose.

39. B. The test built-in will return true and can be used to test for the value existence of a variable not being null. Note that the behavior of the test built-in differs depending on the number of arguments.

40. C. The HOME environment variable, set automatically to the user’s home directory, is consulted when the command cd ~ is entered. The other paths beginning with HOME do not exist by default, and the MAILPATH environment variable shown contains a list of locations where mail is checked when using the shell interactively.

41. B. The TMOUT variable can be set in a given user’s shell, and they will be logged out after the value given (in seconds) of inactivity. The other environment variables listed here do not exist.

42. B. Just as with an if statement where the statement is ended with fi, so too is a case statement ended with the word case spelled backward. The curly brace shown as option D is used to close case statements in many languages but not for shell scripts.

43. A. The provided answer performs command substitution and places the value from the resulting command into a variable. Note the use of +%s formatting on the date, which then formats the output as seconds since the epoch, as specified in the question. Option C will provide the date within the DATE variable but will not format it as specified.

44. B. Wrapping a variable in curly braces, ${FILEPATH}, will ensure that the variable is interpolated or expanded correctly, even when used in a place where it might not normally be expanded, such as within a quoted string.

45. B. In shell scripts, the commands to execute begin at the do keyword and end at the done keyword. Other languages generally use either curly braces or tabs.

46. D. The -r test determines whether a given file exists and can be read by the current user. The -e test only checks to see if the file exists, while -s determines if the file exists and has a size greater than zero. There is no -a file test.

47. A. The -r option to declare will create or mark the variable as read-only. The -p option prints output in a format that can be reused. The -x option declares the variable for export.

48. D. The *) sequence is used to denote a default set of statements that will be executed if no other case matches within the set.

Chapter 6: Understanding User Interfaces and Desktops (Domain 106)
1. A. The greeter is configured through /etc/lightdm/lightdm.conf using the greeter-session option. The other answers provided here are not valid.

2. B. The Screen section of xorg.conf is used to logically bind a given graphics card and monitor, each of which would be defined in its own respective section in the configuration file. The other options shown for this question do not exist.

3. A. Frequency options are one of Hz, k, kHz, M, or MHz, thereby making uHz an unavailable option.

4. C. The systemctl set-default command is used for this purpose, and the target of multi-user is used to boot to the command line. You also need to remove the word splash from /etc/default/grub and run update-grub as well.

5. A. The DISPLAY variable can be used to send the windows of an X session remotely to another computer when using protocols like ssh. There is no XTERMINAL or XDISP environment variable, and XTERM is typically a terminal window and not an environment variable.

6. D. The Welcome option sets the message to be displayed to users within the display manager when they login. For users who are remote, the RemoteWelcome message can be used for the same purpose.

7. C. The Shift key can be used to enable and disable sticky keys within GNOME and other operating systems for accessibility purposes.

8. A. The Disable keyword is used to ensure that a given module is not loaded. Note that a Load statement for the same module takes precedence over the Disable statement, but Disable can be used to unload modules that are loaded by default.

9. A. The Orca project provides assistive screen-reading capabilities within GNOME. Of the other options given, the screen command is valid but it is not used for this purpose.

10. C. The xrandr command can be used to change resolution, and changing the resolution to something like 800×600 would make icons and other items appear larger.

11. D. The allow-guest option changes the behavior of guest login for LightDM, and disallowing guest login would generally make the computer somewhat more secure, though if someone has physical access to the device they might be able to get access in other ways.

12. C. The XFree86 -configure command tells the XFree86 server to query for hardware and create a configuration for the recognized hardware. Note that you may still need to edit the resulting configuration file because of unrecognized hardware or to account for specific configuration items.

13. B. The XkbModel configuration option is used to set the type of keyboard being used, such as pc105 for a 105-key keyboard. The XkbLayout option defines the layout of the keyboard, such as US for United States–style keyboards.

14. B. The VertRefresh option is used for this purpose, and it accepts a range of values in the manner shown. The other options given for this question are not valid for the purpose described.

15. D. The xdpyinfo command displays various elements about the current display(s) along with information about X itself.

16. C. The linear acceleration profile is enabled by setting the AccelerationProfile to 6 within xorg.conf. The 0 setting is known as classic, while -1 provides constant acceleration (no profile), and 7 is known as limited, which performs the same as linear but with a maximum amount of speed and acceleration.

17. A. The /usr/share/fonts hierarchy is used for storage of fonts. Another path that might contain font information is /usr/share/X11/fonts, but that was not among the choices given for this question.

18. C. Kernel versions beginning with 2.6.26 include native support for Braille displays in Linux.

19. A. The DontZoom option prevents the specified key combinations from changing the video mode. Of the other options, the DontZap option changes the behavior of the Ctrl+Alt+Backspace key combination. The other options don’t have any effect and are not valid in xorg.conf.

20. A. The gok command, short for GNOME On-screen Keyboard, is the program to start the on-screen keyboard. The Caribou program will be the successor to gok.

21. C. The gdmsetup program is used to configure various options for the login window and environment, including those for local and remote users. The other options shown for this question are not used for this purpose or do not exist.

22. D. The kmag program magnifies items on a desktop and is used as an assistive technology. In general, kmag can be used with other window managers as well.

23. C. The greeter-show-manual-login option, when set to true, will require the user to enter a username for login rather than selecting the username from a list.

24. B. The Appearance section of the GNOME Control Center is used to set many aspects of how the desktop appears and behaves, including the choice of a high-contrast theme.

25. B. Mouse gestures are commonly associated with assistive technologies and help to facilitate uses of programs by moving the mouse in a certain way. Mouse gestures could be used for login and to capture screenshots, but those are not adequately or generally descriptive of their use.

26. D. The Alt+Super+S keyboard shortcut activates the screen reader in GNOME 3.9 or later. The Super+S shortcut enters Overview. The other shortcuts provided do not have a special meaning by default.

27. D. The startx command kicks off the display manager after login to a local terminal. The other commands shown do not exist or will not work for the purpose described.

28. B. The BlankTime option, which is set to 10 minutes by default, causes the monitor to go blank but not actually go into standby or other power-saving modes.

29. C. The xwininfo command displays information about a given window within an X session. The other commands listed for this answer are not valid.

30. A. The Mouse button displays keys to move the mouse. The Compose button shows a compose keyboard, and the other options are not valid.

31. C. The xhost command is used to control access to the X server. A host is added with the + sign and removed by preceding the command with the - sign.

32. B. The ForwardX11 option must be enabled in order for X connections or windows generated from the X server to be sent over an ssh connection.

33. D. The FontPath directive provides another location in which the server can find fonts. The other options do not exist within the context of an xorg.conf configuration file.

34. D. With an on-screen keyboard, users can utilize a pointer such as a mouse to select keys on the keyboard.

35. C. Bounce keys cause the interface not to react when keys are accidentally pressed in succession or held down.

36. B. The Alt+Ctr+F1 key combination is used to get to a terminal prompt, and it is helpful in situations where the X server won’t start properly.

37. B. The autologin-user option is used to define a user who will be automatically logged in to the system. The other options given in this question do not exist.

38. C. The AccessX utility is used on legacy or older systems to set many of the accessibility options. The functionality provided by AccessX can typically be found in one of the utilities provided by the native X window manager, dependent on the window manager in use.

39. A. The export shell command sets an environment variable. In this case, the DISPLAY environment variable needs to be set. The env command shown will not set the variable.

40. A. The Menus option displays the menu options for a given application so that those options can be manipulated with the keyboard. The Activate option helps to work with the desktop and other applications. The other options shown for this question are not valid.

41. B. The /etc/lightdm/lightdm.conf.d directory contains individual *.conf configuration files for various settings, and it is typically parsed along with the /etc/lightdm/lightdm.conf file.

42. C. In runlevel 3, accessed through the telinit command, the X server is not typically executed. Runlevel 6 will shut down the system. Runlevel 1 switches to single-user mode, while runlevel 5 is a multi-user mode in which X is usually running.

43. C. The VideoRam option, which can be expressed in bytes, configures the amount of RAM available to the video card.

44. A. The ColorDepth option sets the color depth for a given monitor display. A typical value might be 24 for this option.

45. B. The Identifier option provides a unique description of each of the server layouts in an X configuration. The other options shown for this question do not exist.

46. A. The mkfontscale command will create a fonts.scale file that describes outline fonts on the system, and it is used for configuration of fonts that are manually added to the system.

47. A. Display Power Management Signaling (DPMS) enables additional power-saving modes, such as a full sleep mode, which enables further energy efficiency for the display.

48. B. The Emacspeak program provides another visual assistive technology as an alternative to Orca. The other technologies listed here are not related to visualization or assistive technologies.

Chapter 7: Administrative Tasks (Domain 107)
1. C. The /etc/passwd file contains various pieces of information about users on a system, such as username and real name, along with user id (UID) and login shell. The file is world-readable.

2. B. The format for cron is [minute hour day-of-month month-of-year day-of-week] thereby making option B correct for this question.

3. C. The file /etc/localtime, which can be an actual file or a symbolic link, is used to indicate the local time zone. The other files listed as options do not exist.

4. B. The /etc/cron.allow file is a list of users who have permission to create and remove their own cron jobs. The /etc/crontab file is used to store cron jobs, and the other files do not exist.

5. B. The chage command is used for this purpose, specifically with the -E option. When provided with a date, chage will expire the account on that date. When provided with -1, the expiration will be removed.

6. D. Within the /usr/share/zoneinfo hierarchy you will find information on the various regions and time zones available. The files within this hierarchy can be symlinked to /etc/localtime.

7. B. The at command is used to run a series of commands that you enter. Unlike with cron, you can schedule commands from the command line to be executed in the same order as entered, rather than having to create a specific script for the commands. The syntax shown in option B sets the time to be one hour from now.

8. B. The userdel command is used for this purpose and the -r option (lowercase) deletes both the home directory and mail spool files. The -R (uppercase) option informs the userdel command to use a chroot directory.

9. A. The /etc/skel directory contains files that are automatically copied to a user’s home directory when that user is created. The other directories listed for this question do not exist by default.

10. C. Use anacron when you need to schedule a job on a computer that might be off when the job is scheduled. anacron will take care of running the job at its next available time.

11. B. The +%s option will format the date as seconds since January 1, 1970. This option is used frequently in scripting and elsewhere for obtaining a unique timestamp that can be parsed easily as an integer. The other options will not work.

12. C. The –list option shows the available character sets on the system. The other options given for this question do not exist.

13. C. The LC_TIME environment variable is used to control the display and behavior of the date and time, and it can be changed to a different locale in order to achieve the desired display and behavior of date and time formatting. The other options shown for this question do not exist.

14. B. The atq command shows a list of jobs that have been scheduled with the at command. The other commands don’t exist with the exception of option D, which shows the at ­command but with an invalid option, –jobs.

15. D. Setting a user’s shell to /bin/false will prevent them from logging in interactively to the system, such as with ssh. The other options shown for this question are all valid shells and would allow an interactive login.

16. B. UTF-8 provides multibyte character encoding, and it is generally accepted as the standard for encoding moving forward. ISO-8859 is single-byte encoded. The other answers are not valid. UTF-8 is capable of encoding all of the characters defined by Unicode. Another popular, though legacy, encoding is ASCII.

17. A. The groupmod command is used for this purpose, and the -n option is used to change the group name. The other commands listed do not exist.

18. A. The /var/spool/cron/crontabs directory contains a file for each user who currently has one or more cron jobs or entries. Note that the other files listed here are not valid for this purpose.

19. C. The atrm command removes jobs given their ID. The ID can be obtained with the atq command. The atq and at -l commands shown will list jobs but not delete them. The rmat command is not valid.

20. D. The tzselect command will, by default, display a step-by-step menu to select a time zone. The eventual output will include a region/time zone line, such as America/Chicago, as output.

21. B. The getent command is used to display entries based on the /etc/nsswitch.conf file. One use case for getent is when integrating with Microsoft Active Directory or another LDAP service to check if the connection can be made to the LDAP server. The usermod command is valid, but it is not used for this purpose, and the other commands shown for this question are not valid.

22. B. The /etc/login.defs file contains various configuration items such as the minimum and maximum user and group IDs to be used on the system.

23. C. The /etc/crontab file is a plaintext file that is treated as a system-wide cron file. As such, the file is generally not associated with any single user and it’s not necessary to run a special command after editing this file.

24. D. The TZ environment variable is used for this purpose and the general format is as shown, thus making option D the correct answer.

25. A. The /etc/cron.daily directory contains files such as scripts that are executed daily. There are corresponding cron.hourly, cron.weekly, and cron.monthly directories that run on their respective schedules, as indicated by the name of the directory.

26. C. Setting LANG=C is an alias for POSIX compatibility and will cause programs to bypass locale translations. The other options shown for LANG are not valid.

27. B. The -m option causes the user’s home directory to be created. By default, if this option isn’t specified and CREATE_HOME has not been set, the home directory won’t be created. The -h option displays help text and the other options shown are not valid.

28. A. The usermod -L command locks an account by placing an ! at the beginning of the encrypted password. If the user has another means to log in, such as with an ssh key, using usermod -L will not prevent their login. This option is frequently used when creating special purpose accounts.

29. C. The LC_ALL variable can be used to set environment variables such as the locale, and the variable will then override others. This can be used when there is a need for a temporary change. The other variables listed here are not used for this purpose and are not created by default.

30. A. The format when adding a username places the username between the schedule and the command to run, thereby making option A correct. The other options shown for this question are invalid. In the case of option B, there is no schedule. In the case of options C and D, the schedule is incorrectly formatted.

31. C. The passwd command is used for this purpose. The -a option displays all users but requires the use of -S to indicate status. The -S option alone will not produce a report for all users, and the –all option is an alias for -a.

32. D. The chage command is used for this purpose. The -d option sets the days since the last password change, and it is measured in days since January 1, 1970. The -W option is the number of days of warning for changing a password, and the -l option displays a list of the various settings related to the account.

33. B. The file /etc/anacrontab contains information about the jobs, such as the job name and delay, among other information. The other files listed do not contain anacron-related information about jobs.

34. A. The ln command is used for this purpose, and the -s option creates a symbolic link while -f forces or overwrites the destination. The other options or order of commands are not valid.

35. B. The /etc/cron.deny file contains a list of users who cannot create cron scheduled tasks. The file /etc/cron.allow is used to provide a list of users who are allowed to create cron jobs. The other two files do not exist by default.

36. B. The /etc/shadow file contains usernames, UIDs, and encrypted passwords and is not readable by any non-root user on the system due to the sensitive nature of the encrypted passwords. The /etc/passwd file contains usernames and UIDs but not encrypted passwords. The other two files listed for this question do not exist.

37. D. There is no direct relationship between the UIDs and GIDs on a system. UIDs represent users, whereas GIDs represent group IDs. On some systems, the UID and GID number will match for regular users, but this is not a requirement and is more of a coincidence.

38. B. The dpkg-reconfigure command is used to cause the configuration questions to be asked again. The tzdata package is the name of the package on Debian-based systems. The two apt- commands shown are not valid.

39. A. The usermod command is used for this purpose. The -d option changes the home directory, whereas -m moves the contents. The other commands shown for this question are not valid.

40. D. The -G option is a list of supplemental groups to which the user will be added. A lowercase -g option provides the primary GID. The -l option causes the user not to be added to the lastlog and faillog databases. There is no -x option.

41. A. The crontab command can be used for this purpose and the -l option is used to list the crontab entries. The -u option is needed to specify a user other than the current user.

42. A. The -r option creates a system user, which will typically entail no expiration, no home directory, and a UID below 1000. The -s option defines the shell and is not typically used for this purpose. The -a and -S options do not exist.

43. B. The /etc/gshadow file contains secure information such as an encrypted password for groups, where applicable. The /etc/group file contains general information on groups. The other two files listed as options do not exist.

44. C. The LC_MONETARY variable is used by certain programs to determine the localization for currency.

45. B. groupdel cannot delete groups unless there are no users who have the given group as their primary GID. There is no -f or -r option. The groupadd command can be used to add a new group to the system.

46. A. The id command shows the username, UID, primary group and GID, along with ­supplemental groups. The passwd and chage commands are not used for this purpose. There is no getid command.

47. D. The -c option changes the comment field in /etc/passwd. The comment field is typically associated with the real name of the account. The -R option indicates a chroot directory, while -d indicates a change of home directory. There is no -n option.

48. D. The find command should be used for this purpose. The correct syntax is shown in option D. The grep command will merely look in the specified files for the number 1501, and the -u option to grep includes byte offsets, which is not applicable for this question.

Chapter 8: Essential System Services (Domain 108)
1. C. The journalctl command is used to work with the systemd journal. On systemd-based systems, journalctl is a central command for debugging and troubleshooting.

2. C. The kern facility receives messages from the kernel for logging purposes. Of the other options, syslog is used for logging messages about syslog itself. The other two options shown are not valid syslog facilities.

3. D. ntp.org provides a free service for time synchronization. When you use pool.ntp.org as the target, you will typically receive an NTP server that is geographically close to your location, or at least as close as possible. Setting your address to 127.0.0.1 or 192.168.1.100 will use a local server, but only if that server has an NTP service.

4. A. The service used for logging on a computer managed by systemd is called systemd-journald. You use journalctl to view logged entries rather than the standard Linux toolset.

5. B. The newaliases command re-creates the aliases database on servers running Postfix, sendmail, and qmail. There is no need to restart the mail server after running newaliases. The alias command shown in option C will create an alias for the command shell but is not related to Postfix.

6. D. Configuration files for CUPS are found in /etc/cups. However, it is also common to manage CUPS through its web interface. The other directories listed are not valid.

7. A. The Allow directive is used for this purpose and the addresses 192.168.1.1 through 192.168.1.127 signify a /25 in CIDR notation, thereby making answer A correct. Note that option B, with a /24 netmask would allow the addresses too but would also allow 192.168.1.128 through 192.168.1.255, which is larger than should be allowed.

8. B. The ntpdate command provides a command-line interface that immediately changes or sets the time according to the NTP server given as its argument. The ntpd answer provided in option A will run the NTP daemon and would not be appropriate for a script. The other two commands are not valid.

9. B. Typically, the Connection refused message from an NTP-related command means that the daemon is not running. There is no indication that the ntpq command is querying a different server; therefore, whether the network is up or down is irrelevant. The permission-based options for this answer are not valid based on the error message indicated.

10. D. The hwclock command is used both to query and set the hardware clock, such as the one maintained by the system firmware or BIOS. The ntpdate command is used to set the local system time, but it is not related to the hardware clock. The other commands are not valid.

11. B. Qmail directories are contained within /var/qmail by default. The queue directory is /var/qmail/queue. The other directories are not valid on a default configuration of qmail.

12. D. The info severity level provides information messages for a given facility. Of the options given, emerg is used for emergency messages and not normally used by applications, whereas debug is the highest or most verbose level of logging available through syslog. Configuration for syslog is typically found in syslog.conf or syslogd.conf within the /etc/ hierarchy.

13. B. The driftfile configuration option sets the location of the driftfile for ntpd. The drift file helps to maintain time accuracy. The location shown is the default for Red Hat Enterprise Linux.

14. A. The mail option is used to send the log to the specified e-mail address on completion of the logrotate process. The other options shown do not exist as options in /etc/logrotate.conf.

15. C. The journalctl command is used for this purpose and the –disk-usage option displays the disk space used by journal log files, which are typically stored in /var/log/journal. Journal-related configuration is found in /etc/systemd/journald.conf.

16. D. The mailq command is used on Postfix servers in order to view a summary of the current mail queue. Details of the queue include the ID of the mail being sent along with one or more of the e-mail addresses involved in the transaction. The mailq command may also work with newer versions of sendmail.

17. C. The ntpq command provides an interactive, menu-like interface into the NTP server. You can use ntpq to check statistics on peers, for example. The ntpdate command shown as option B is used as a command-line means to set the time. The ntpd command shown as option A would execute the NTP daemon itself.

18. D. The format is user: destination for the aliases file, thereby making option D correct. The other options are not valid syntax for the aliases file.

19. B. The -f option indicates the file to which messages will be logged. The -d option is used for debugging, while -v prints the version of klogd. There is no -l option for klogd.

20. C. Individual configuration files for various log file rotation policies are found in /etc/logrotate.d. This directory is included from the primary configuration file /etc/logrotate.conf.

21. A. The lpr command places a file (or standard input) into the print queue for lpd to work with. The lpq command prints the current queue. There is no lpx command.

22. C. The -bp option to the sendmail command prints information about the current queue. There are no -queue or -f options that are relevant for this question. The -bi option is used to work with the aliases database.

23. A. The -w option sets the hardware clock to the current system time. The -s option does the opposite, setting the system time to the hardware clock. There is no -a or -m function for hwclock.

24. D. TCP port 631 is used as the administrative interface into CUPS. Visiting an active CUPS server on that port will show the administration website for working with print queues and other configuration items related to CUPS.

25. A. The -q option causes sendmail to attempt to deliver messages from the queue. Add the -v option to display verbose output.

26. B. The requirements of multiple e-mail addresses prevent the use of .forward; therefore, it will need to be accomplished in /etc/aliases. The format for multiple e-mail addresses is to separate them with a comma, thereby making option B correct.

27. A. The –systohc will set the hardware clock according to the current system time. The use of –utc is required in order to ensure that the time is set to UTC. If –utc is omitted, the time will default to whatever was used the last time the command was run, which could be UTC but might also be localtime instead. Therefore, the best option is A.

28. D. The postsuper -d command deletes messages from the queue. The ALL keyword causes all messages to be deleted from the queue. You should take care when performing this action because it is irreversible. There is no -remove option to postqueue and the -f option for postfix is not relevant. The rm -rf command shown is not specific enough, and it is generally not recommended to remove files from a mail queue manually.

29. A. The URL shown will display the jobs area of the local CUPS server with a query string name of which_jobs and a value of completed. The other URLs shown are not valid.

30. C. Just as the tail -f command will continuously update the display as new content is added, so too does the -f option display new entries for journalctl. The -t option shows messages for the given syslog identifier. There is no -tail or -l option.

31. B. The $UDPServerRun option is used for the purpose described. The port on which the server should listen is then provided as the value for this option. The other options shown are not valid configuration items for rsyslogd.

32. A. The postqueue -f command is used to flush the queue. The command will process all of the e-mails that are awaiting delivery. The other commands are not valid for this purpose.

33. C. The -g option specifies the maximum offset or skew that can be adjusted for when synchronizing time. When set to 0, there is no offset check.

34. A. The SystemMaxFileSize option controls the size of the journal log file to ensure that a log does not cause problems related to disk usage. The SystemMaxUse option controls overall size of journal files and the default for SystemMaxFileSize is 1/8 of the SystemMaxUse setting to allow for rotation of files.

35. C. The lpstat command is used for this purpose. The lpstat command displays information about printers, print jobs, and related information. The -W option specifies which jobs to display, completed or not completed. The lpq command shown as an option is used to view the queue, and the other options are not valid.

36. D. The postrotate option within a configuration for log rotation can be used for this purpose. After postrotate, a line typically follows with the script or commands to execute. The other options shown for this question are not valid.

37. B. SMTP operates on TCP port 25, and if other servers are contacting your SMTP server, then you’ll need to listen on this port and allow traffic to it as well. Port 23 is used for Telnet, port 110 is POP3, and port 143 is IMAP, none of which are necessary for SMTP traffic.

38. A. The makemap command is used to create the hashed database in the correct format for sendmail to use. The other commands are not valid for sendmail.

39. A. The configuration file for syslog-ng is stored in /etc/syslog-ng and is named syslog-ng.conf. There is typically not an /etc/syslog directory, even on systems without syslog-ng.

40. C. The application could theoretically use any of the logging facilities, depending on the type of application being developed. However, the requirement to log to a custom log file means that the logs will have a different name and possibly location than the standard logs. Therefore, logging to any of the standard or system-level facilities is not appropriate for this scenario, thereby making one of the local (local0 through local7) facilities appropriate.

41. B. The usermod command with the -aG option is used to append a group onto the user’s list of groups. In this case, the user needs to be a member of the lpadmin group.

42. D. The nocompress option is used to prevent the log file from being compressed or zipped as part of the rotation process. This might be needed on systems where compression negatively affects performance or where additional processing is necessary.

43. D. The -s option sets the date and time as specified within the command. If there is another means to set the date automatically, it may override the change. For example, if ntpd is running, that process may alter the date even after it has been set with date -s.

44. B. The mailstats command is used for the purpose described. Of the other options, the mailq command will display the current mail queue but not statistics on mail that has been processed. The other two options are not valid commands.

45. D. The logger command is used to send messages to syslog and can be executed in a shell script context in order to take advantage of the robustness of syslog without having to write separate log management into the script.

46. A. The systemctl command is used for controlling services. In this case, restart should be sent to the CUPS service as denoted by the name cups.service.

47. C. The use of - indicates that syslog does not need to sync to disk for every log entry. This can greatly improve performance for busy systems but may cause log entries to be lost if the sync process has not been run prior to a system crash or other issue.

48. A. The Port configuration option is used for this purpose and is used as an alternative to the Listen directive. With the Listen directive you will specify address:port. However, option C, while valid syntactically, will only listen on the localhost IP address of 127.0.0.1 and not all interfaces.

Chapter 9: Networking Fundamentals (Domain 109)
1. A. The netstat command can be used for this purpose, and the -r option displays the current routes. The addition of -n prevents DNS lookups, which can help with performance.

2. A. The ifconfig command can be used for this purpose, and it requires the addition of the -a option because the adapter is currently down. The ifup command can be used to bring up an interface, but it does not display information by default. The netstat command displays information about the network but not with the -n option.

3. D. Private IP addresses are found within the 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16 ranges, thus making an address in the 143 range a public IP address.

4. C. The route command is used for this purpose, and adding a route is done with the add option. The default gateway is added using the default gw keywords followed by the IP address of the gateway and the adapter.

5. A. The host command enables changing of the query type with the -t option. Using ns as the type will query for the nameservers for a given domain. There is no all type, and the other options are also invalid.

6. B. Traditionally, UDP/53 is used for DNS queries, but with a primary and secondary server it is assumed that zone transfers may occur. DNS zone transfers typically take place over TCP/53.

7. B. The -I option enables the choice of interface. A lowercase -i option sets the interval, while -a indicates an audible ping. Finally, -t enables a TTL-based ping only.

8. D. A /27 with a netmask of 255.255.255.224 splits a subnet into four segments of 32 addresses, thus enabling 30 usable addresses.

9. A. The host or dig commands can be used for this purpose by setting the type to mx. The mx type will query for the mail exchanger for the given domain. There is no smtp type.

10. B. The localhost address for IPv6 can be written as ::1. Addresses shown like 127 represent the IPv4 localhost range, but they are not written properly for IPv4 or IPv6.

11. A. The -T option causes traceroute to use TCP packets. This option, which requires root privileges, can be helpful in situations where a firewall may be blocking traceroute traffic. The -i option chooses the interface, while the -s option chooses the source address. A ­lowercase -t option sets the Type of Service (ToS) flag.

12. C. The ifup command is used to bring up network interfaces, and the -a option brings up those interfaces marked as auto. The ifconfig -a command displays information on all interfaces, and there is no ifstat command. The ifdown command can be used to bring interfaces down or offline.

13. D. The hostname command is used to return the hostname and domain. When given the -d option, just the domain name is returned to STDOUT, thereby making it appropriate for use in a script.

14. A. The ip command with the monitor option/subcommand will display netlink messages as they arrive. There is no netlink subcommand for ip and the route command will not work for this purpose.

15. D. The -6 option, as in traceroute -6, executes an IPv6 traceroute. The other options shown for this question are not valid. It would be rare for the traceroute6 command not to be available and still have the traceroute -6 command available.

16. A. The syntax is database: databasename with additional databasenames separated by spaces, as shown in the correct option for this question.

17. A. The @ symbol is used to indicate a server to which the query will be sent directly. This can be quite useful for troubleshooting resolution problems by sending the query directly to an authoritative name server for the domain. Of the other options, -t sets the type and the other choices are not valid.

18. D. SNMP traffic takes place on ports 161 and 162. Though the traffic is usually on UDP, the TCP ports are also reserved for SNMP. Ports 110 and 143 are used for POP3 and IMAP, respectively, while 23 and 25 are for Telnet and SMTP. Finally, ports 80 and 443 are for HTTP and HTTPS.

19. A. The getent command is used for working with NSS databases, and getent hosts will display the available hosts using the databases configured in /etc/nsswitch.conf.

20. D. A /25 in CIDR notation represents half of a /24 in address space, therefore making 255.255.255.128 the masked bits. The 255.255.255.0 answer is /24 while 255.255.255.192 is /26. Finally, 255.255.0.0 is /16.

21. C. The configuration option is called nameserver, and the value for the option is the IP address of the desired nameserver. There are several options that affect how name resolution is performed, such as the number of attempts and timeout. See resolv.conf(5) for more information.

22. D. The /etc/services file contains standard port-to-protocol information based on the well-known and assigned ports from IANA. If you’d like to provide a custom name for the service, you can do so by editing this file. There is no /etc/ports or /etc/p2p file by default, and /etc/ppp is usually a directory for the point-to-point protocol daemon and related services.

23. A. The route command can be used for this purpose, and the syntax includes the network range, denoted with the -net option, followed by the word netmask and the masked bits, followed by the word gw and the IP address of the gateway. The other options shown are invalid for a variety of reasons, including missing keywords and options and order.

24. A. The netstat command is used for this purpose and the -a option displays all sockets, listening and non-listening. Note that it’s frequently helpful to add the -n option, or combine them as in netstat -an, in order to prevent name lookup. Doing so can significantly improve performance of the command.

25. A. The correct format is IP address followed by canonical hostname followed by any aliases for the host. You can use entries in /etc/hosts to override DNS lookups, which can be useful in preventing those names from resolving or to provide a different resolution.

26. C. The ifconfig command for configuring interfaces begins with the device followed by the IP address, which is then followed by the netmask keyword and the netmask to add. Because this is a /24, the netmask is 255.255.255.0.

27. C. IPv4 addresses are 32 bits in length and IPv6 addresses are 128 bits. Both IPv4 and IPv6 can be used on internal and external networks alike, and there is indeed subnetting necessary with IPv6.

28. D. ICMP is a layer 3 protocol, meaning that it does not use ports for communication. TCP/43 is used for whois, while port 111 is used for sunrpc. UDP/69 is used for TFTP.

29. B. The ip route command can be used for this purpose, and its syntax uses a change command and the via keyword. The same operation could be completed with the route command, but that would require first deleting the existing gateway and then re-adding a new default gateway.

30. C. Secure Shell, or ssh, operates on TCP port 22 by default. TCP/23 is used for Telnet; TCP/25 is SMTP, and TCP/2200 is not associated with a well-known service.

31. B. The nc command is used to start netcat, and the -l option causes it to listen. The -p option is used to specify the port on which netcat will listen. The -s option specifies the local source address, and it is not used for this scenario.

32. A. The soa type is used to query for Start of Authority records for a domain. Note that in many cases, dig will attempt to look up the domain within a given command and may not appear to have had an error. For example, when running option D (dig -t auth example.com), you will receive information about example.com and there will be a line in the output that dig has ignored the invalid type of auth.

33. A. The search option is used for this purpose, and it can be provided with multiple domain names, each separated by a space or tab. The domain option is valid within /etc/resolv.conf, but it does not allow for multiple domain names.

34. C. The ping6 command is used to ping IPv6 addresses. Unique local addresses are the IPv6 equivalent of RFC 1918 private addresses in IPv4. In IPv6, fc00::/7 is the unique local address space. Note that there is no -6 option to the normal ping command.

35. A. The route command can be used for this purpose and in the scenario described, a reject destination is used for the route. The other options shown are invalid because they use invalid options to the route command.

36. B. The tracepath command provides the maximum transmission unit (MTU) of the hops, where possible. Both traceroute and tracepath can be used internally or externally, and both provide IPv6 capabilities. Certain options with the traceroute command can require root privileges, but not enough information was given in the question for that to have been the correct option. The tracepath6 command provides native IPv6 capabilities.

37. D. The -c option provides the count of the number of pings to send. The -n option specifies numeric output only, while -p specifies the pattern to use for the packet content. Finally, the -t option sets the TTL.

38. B. NXDOMAIN is the status for a non-existent domain or host, basically meaning that the host for which the query was sent does not exist. A normal status when there has not been an error is "NOERROR".

39. A. In order to facilitate the scenario described, the syntax for ifconfig uses the device followed by the protocol, inet6 in this case. Next, the keyword add is used to indicate that an additional IP address is being added. Finally, it is followed by the address itself.

40. C. LDAP over SSL, or LDAPS, operates on port 636. Port 53 is used for DNS, port 389 is used for normal, non-SSL LDAP, and port 443 is used for HTTP over SSL.

41. D. The best option for this question is to add an entry for the host in /etc/hosts. Doing so will always cause DNS queries to resolve to 127.0.0.1. The other options are not as robust because they rely on www.example.com always having the same IP address, or the solutions require additional maintenance to constantly add new IP addresses if www.example.com’s IP address changes.

42. A. The ip route flush cache command should be executed after changing the routes. The other commands shown for this question are not valid.

43. A. SPF records are stored in the txt record type in DNS, thereby making -t txt the correct option for this question. Of the other answers, only -t mx is valid and returns the mail exchangers for the given domain.

44. B. TCP is a connection-oriented protocol that uses a three-way handshake to establish a connection. ICMP does not use ports for communication, while UDP is connectionless. IP is the core Internet Protocol, and it does not use a handshake.

45. D. There are 1,048,576 IP addresses in the 172.16.0.0 private range. There are 16,777,216 in the 10.0.0.0 range and 65,536 in the 192.168.0.0 range.

46. C. The only viable possibility of those listed is that ICMP traffic is blocked. TCP traffic is obviously passing because of the ability to get there using HTTP, and DNS must also be working.

47. C. The G signifies a gateway within the route table.

48. A. The axfr type is a zone transfer, and the @ symbol signifies the server to which the query will be sent. There is no xfer type, and option B is just a normal query for the domain sent to the specified server.

Chapter 10: Security (Domain 110)
1. A. If /etc/nologin exists, users will be prevented from logging into the system. The root user can still log in, assuming that root logins are enabled within the ssh configuration.

2. B. The find command is used for this purpose, and the permission can be described as 4000 to indicate the presence of the setuid bit. The -type option can be used for changing the type of object to be returned, but it is not relevant for the scenario described.

3. B. The lsof command can be used for this purpose, and with the -i option it will display the network ports along with their process. The netstat command will display network ports but not the process with the -a option. The ps command is used for processes but not network ports. Finally, there is no netlist command.

4. A. The fuser command can be used to determine which process is using a given file. The ls command will show files, and find can be used to find files but not specifically for this purpose. The ps command does show processes but it is not necessarily tied to a particular file.

5. D. The chage command is used for working with account aging information such as expiration date, password change, days between password changes, and so on. The -l option lists information for the given account. The usermod command is used to make changes to an account, and the other two commands are not valid.

6. A. The nmap command is used to scan for open ports. The nmap command will scan for open TCP ports to the address or addresses specified. The other commands shown do not scan for open ports to external (off-host) IP addresses.

7. B. The ssh-keygen command is used to create a key pair for use with ssh instead of a password. Of the other options, the ssh command does exist but the -k option is used to disable GSSAPI credential forwarding and not for the purpose described.

8. B. The format is username (or other specifier) followed by hard or soft, depending on the limit type, then the keyword followed by the value for that given keyword.

9. A. The file authorized_keys, stored in the .ssh directory in your home directory, contains public keys that are authorized to log in to the server using their corresponding private key.

10. C. The -p option shows the process ID to which a given port is connected, and it is useful for displaying information about which process is listening on a given port. The -a option shows listening and non-listening sockets, while -n disables name lookups. The -l option shows listening sockets only.

11. D. Loading of alternate files is accomplished using the -f option. Doing so facilitates exactly the scenario described, being able to examine logins from old log files. The -a option controls the location of the display for the host, while -t controls the display of the logins as of the specified date and time. There is no -e option.

12. D. The w command shows currently logged-in users along with information such as uptime and load average. The fuser command is used to show open files, and the -u option to ls controls the display for file listings. There is no listuser command.

13. A. The -u option is correct for this purpose. An uppercase -U option sets the user context for listing privileges. The -s option sets the shell, and the -H option sets the home directory.

14. B. The NOPASSWD option causes sudo to not prompt for a password for a given sudo command. This is useful for scripted scenarios where a password prompt would cause problems.

15. C. The ulimit command shows such limits, and the -a option shows all limits for the currently logged-in user. The other commands are not valid.

16. C. The syntax to block access to every service uses the ALL keyword followed by the address or network to which the policy will apply.

17. A. The correct format is YYYY-MM-DD for the usermod command.

18. C. The disable option is used for the purpose described and can be set to yes or no. The other options are not valid for this scenario. Configuration for xinetd is controlled by /etc/xinetd.conf.

19. A. The file is named id_rsa by default, and the public key is named id_rsa.pub. For DSA keys, the names are id_dsa and id_dsa.pub.

20. C. The -c option executes a single command but does so without an interactive session. The -s option specifies the shell to be used. There is no -u or -e option for the su command.

21. C. The send-key option followed by the name of the key sends the key to the key server specified by the keyserver option. This is a typical scenario for sending a locally generated public key to a public server for others to use. The other options shown as potential answers do not exist.

22. B. There is no special option necessary in order to execute a single command on a remote host with ssh. The -s option requests a subsystem and is not related to this scenario. The -e option specifies an escape character.

23. D. The ssh-add command is used to list currently loaded keys, and it is used in conjunction with ssh-agent. There is no -l option to ssh-agent and the -l option to ssh specifies the login name to use. There is no ssh-list-keys command.

24. C. While any text editor can be used, it is highly recommended to use the visudo command to edit /etc/sudoers. Using visudo enables syntax checking, which will help to prevent issues with an invalid configuration causing problems for those who rely on sudo.

25. A. The systemctl command will be used for this purpose, and the subcommand is disable. There is a stop subcommand, but it will only stop the given service rather than prevent it from starting on boot. The other options are invalid for various reasons including that they use systemd as the command name rather than systemctl.

26. B. The chage command can be used for this purpose, and the -E option accepts days since 1/1/1970. There is no -e option to passwd, and -l for usermod will not perform the action described. There is no chguser command.

27. A. Setting -P0 will cause no ping requests to precede the scan, and it is useful for the scenario described. There is a -s option, but it is not used for this purpose. The other options are not valid.

28. C. The maxlogins parameter is used to control the number of simultaneous logins for a given account.

29. B. The file ssh_known_hosts, typically kept in /etc/, is used for the purpose described. Note that on some systems this file and other ssh-related configurations may be found in /etc/ssh/. The answers that indicate ~ or within /root are incorrect because the question specifies a server-wide list.

30. C. The date of the last password change, as measured in days since January 1, 1970, is contained in the third field of a shadow entry. The expiration date would be the eighth field, as separated by colons.

31. A. The format for local forwarding uses the -L option followed by the local port and then the remote host:port combination. This is typically followed by the user@host credential and destination information for the ssh connection itself.

32. C. The option is called X11Forwarding, and it must be set to yes in order for the destination server to forward X-based windows to the local client computer. The other options shown are not valid.

33. A. The –gen-key subcommand is used for the purpose described. The other options shown do not exist.

34. D. The % is used to denote a group within /etc/sudoers, and it provides an excellent way to facilitate an administrative privileged group.

35. A. The -p option sets the port for login, and it is useful for scenarios where you cannot use the host:port syntax. There is no -P or @ option with ssh, and the -l option specifies the login name.

36. A. The -s option sets the type of scan, and when followed by an uppercase S, it sets the option to SYN. The T option is a Connect() scan. There is no Y option or -type option for nmap.

37. C. The wtmp file, stored in /var/log is used to store recent login information and must be read with the last command due to its format. The other logs listed for this question are not default logs found on a Linux system.

38. A. The -i option for ssh is followed by the private key to use for authentication. Doing so implies that the public key is in the authorized_keys file on the remote host. The -k option disables sending of GSSAPI credentials, while -f is used to request backgrounding of ssh. There is no –key option.

39. A. The -n option facilitates the scenario described, and it will exit non-zero rather than prompting. The -i option sets the login name, and it is not valid for this scenario. The -q and the –noprompt options do not exist.

40. C. The ssh-keygen command is used for this purpose, and the -t option specifies the type of key to generate. There are no key-related generation options for the ssh command. Overall host keys are stored in /etc/ssh/ssh_host_rsa_key and /etc/ssh/ssh_host_rsa_key.pub for RSA keys, and /etc/ssh/ssh_host_dsa_key and /etc/ssh/ssh_host_dsa_key.pub for DSA keys.

41. B. Lines can be commented out of /etc/inetd.conf with a pound sign or hash mark (#). After making changes to /etc/inetd.conf, you should restart the service. Many systems also utilize /etc/inetd.d/ to store configuration files related to specific services.

42. A. The -L option to usermod can be used to lock an account. The lowercase version, -l, is used to change a username. The other commands do not exist.

43. B. The file pubring.gpg, found in ~/.gnupg, contains the public keyring.

44. C. The file .gpg-v21-migrated, when present, indicates that gpg version 2.1 or later is in use and the files have been migrated for that version or a later version.

45. D. The find command is used for this purpose, and the -perm option is needed, specifically as the 2000 permission to indicate setgid. Note the use of / to indicate that the entire server will be searched. The grep command shown cannot be used for this purpose because it looks for the presence of the string setgid within files located in the current directory only.

46. C. The update-rc.d command creates symbolic links from a service file in /etc/init.d/ to the appropriate locations in /etc/rc.d/* for each runlevel. The other commands shown are not valid.

47. A. Single-user mode is typically runlevel 1. In runlevel 1, no network services are started. Runlevel 2 has networking but typically not services. Runlevel 5 is full multiuser with networking, and runlevel 6 is reboot.

48. C. The single dash - is the typical option passed to su for login. There is no -u or -U option, and the -login option does not exist. There is a –login option (with two dashes), but that is not what’s shown.

Chapter 11: Capacity Planning (Topic 200)
1. D. The -p option to iostat displays information on devices and partitions. The -c option shows CPU utilization, and -d shows device utilization. There is no -a option.

2. B. Filters are used within iptraf to define traffic that should be included or excluded when monitoring. For this scenario, you could define the source IP address as your own and the destination as that of the interface being monitored and then look specifically for destination port 22 for ssh.

3. D. The vmstat command is used to display extended information about performance including blocks in and out. The iptraf command is used to provide network-level monitoring, and the other two commands listed are not valid.

4. C. The iotop command is used to monitor disk usage, such as reads and writes on a per-process basis in real time. The top command does not provide disk usages, and iostat does not provide information in a per-process manner. Finally, free provides aggregate information on memory.

5. D. Nagios provides advanced monitoring capabilities appropriate for the scenario described. Nagios works using various plugins that monitor numerous aspects of devices and systems. ntop and mrtg both provide graphical statistics but do not have the alerting capabilities specified.

6. B. The w command shows a variety of useful information including load average, logged-in users, and other uptime information. The uptime command does not show who is currently logged in. There is no swap or sysinfo command.

7. B. The free command shows current memory usage for both RAM and swap space, including total available, current amount used, and current amount free. The other commands shown as options do not exist.

8. B. Pressing Shift+F within top enables you to choose which columns display as well as the sort order for these columns. In the scenario described, you can view the processes using the highest amount of memory.

9. A. The df command displays information on disk usage, and it can help with planning disk utilization over time. For example, if you note that disk utilization is increasing significantly, you can prepare to bring more disk online or even to change the log rotation schedule such that logs are rotated faster, thereby freeing up space.

10. C. Cacti is a graphing tool that uses both scripts for gathering performance data as well as SNMP. The graphs can help you visualize the performance of networks and systems alike. The pstree command is used to show a tree-like structure of processes.

11. A. The ps command provides information on processor and memory usage for individual processes. You can use this information to predict capacity.

12. A. The -p option enables monitoring of one or more process IDs. If you’re monitoring more than one process ID, separate each with a comma. The -s option sets the sort order. The -a and the -e options do not exist.

13. C. The -a option displays statistics for each socket, both listening and non-listening. Included in this information are the send and receive queues. This information can be used to gauge performance and potential bottlenecks.

14. B. The iptraf tool is used for monitoring network traffic in real time to provide statistics on usage and throughput. The tool is graphical in nature, but it is appropriate for use over an ssh connection without an X server installed. The other commands listed as options are not valid Linux commands.

15. C. The pstree command displays current processes in a tree-like structure, with parent processes connected to child processes. The pstree command makes it easy to see processes in a grouped format to check for potential high resource usage.

16. A. The sar command can be used for this purpose, and when provided with numbers in the format displayed, it will update every X seconds for Y executions, as in the answer with sar -u 2 10, which will update every two seconds for 10 executions.

17. A. The htop command enables advanced scenarios for working with processes through a graphical interface created with ncurses. This means that the interface is appropriate for use through ssh, for example.

18. C. The wa statistic shows time spent waiting for I/O, and it can be used to measure or find a bottleneck related to disk. The us statistic is time spent on user space processes, while sy is time spent on kernel processes. There is no statistic called io within vmstat.

19. C. The -p option to pstree shows process IDs along with the standard pstree output. The -a option displays command-line arguments for commands. There is no -i or -b option.

20. C. The RSS column is Resident Set Size, and it indicates the amount of physical RAM that is allocated to the given process.

21. B. The lsof command is used for this purpose, and it can help if there are large files that may be affecting performance. The ls command does not show whether a file is open.

22. B. The l key will list open files for a given process, assuming that lsof is installed. The L key performs a library trace if ltrace is available.

23. D. The steal column shows the percentage of time that was spent waiting due to the hypervisor stealing cycles for another virtual processor.

24. B. While all of the commands and programs listed are typically available on modern Linux distributions, all of them need to be installed separately except the top command, which is usually available for performance troubleshooting and monitoring.

25. A. Load average with the uptime command is displayed in 1-, 5-, and 15-minute ­increments.

26. B. The /proc/swaps file can be used to gather information quickly, especially within a script, on swap space.

27. C. The ntop program monitors network interfaces and provides web-based reporting on bandwidth utilization by protocol and host. Both mrtg and Nagios can provide similar information but typically not on a per-protocol or per-host basis.

28. B. Providing information from ps in a wide format can be helpful for viewing the command line of a given command. The a option displays all processes while the o option enables the choice of columns for output.

29. A. When no interval or count are provided, the gathered statistics are displayed for each interval in which statistics were gathered. For example, if sar gathered statistics every five minutes since the last restart, then each of those data points is displayed.

30. C. The -i option is needed for this case, and the format for the port is preceded by a colon.

31. C. The -m option causes the disk-related statistics to use megabytes as the scale rather than the default kilobytes.

32. B. If the Stat column within the output of a ps command shows D, then there is a process in uninterruptible sleep, meaning that it cannot be killed and is typically waiting on I/O. A process in Sl is in normal sleep for a multithreaded process. Rebooting the server is the only way to clear processes that are in uninterruptible sleep, assuming that they don’t wake up of their own accord. Finally, the -n option to vmstat selects how the header is displayed.

33. B. The -d option is used to set the delay, and the interval is tenths of a second, thereby needing 100 such intervals to equal 10 seconds.

34. A. The vmstat command displays both memory and CPU usage information. The iostat command does not display memory information. Once you know the command, then it’s a matter of the correct syntax for per-second updates for 10 seconds.

35. D. The netstat -s command displays aggregate statistical information for networking, including the total packets received and the number of packets forwarded. The ifconfig command does not show packets forwarded. The ls command is not used for networking, and the ipstat command does not exist.

36. A. On a system with one processor, a load average of 1.00 would indicate high utilization. However, with two processors that load average equals approximately 50% capacity. Even at 50% capacity, it might be a good idea to examine what is causing that utilization with the top or ps command.

37. B. When a 0 interval with no value for count is sent as an argument to sar, the overall averages since last restart will be displayed, and the program will exit.

Chapter 12: Linux Kernel (Topic 201)
1. B. The make oldconfig command will integrate the existing configuration file into the new configuration for the kernel. You still need to take care for items that have moved or changed within the new kernel to ensure that the configuration is correct.

2. A. Kernel source code is usually kept in /usr/src/linux.

3. D. The xz command is used to both compress and decompress files. When used with the -d option, the file provided as an argument is then decompressed.

4. A. The legacy zImage format is limited to 512 KB in size, while bzImage does not have such a limitation.

5. B. The menuconfig target provides a graphical-styled interface for choosing kernel options, and it is appropriate to use over an ssh connection. Be careful compiling a kernel over ssh, though. If you choose the wrong options, the server may not boot successfully. Thus, make sure that you have another means to access the console.

6. A. The mkinitrd command is used on older systems to create the initial RAM disk. The initial RAM disk is used to load—some might say preload—essential modules for things like disks and other vital components needed for booting.

7. C. When available, bzip2 is used to compress a bzImage. bzImage describes a different format for compressed kernel images that can go above the 512 KB limit that normally applies to a zImage.

8. B. The kernel config is placed in /usr/src/linux/.config. It’s a good idea to make a backup of this file in case you need to re-create the kernel from source in the future or for reference.

9. B. The lsmod command is used to display currently loaded modules. This is useful for scenarios where you are migrating from the stock or distribution-provided kernel to a custom kernel and need to know which modules to compile into the new kernel.

10. B. The clean target removes most compiled files, though some may be left such as those related to kernel compilation. The mrproper make target removes compiled files from previous compiles of the kernel but also cleans the .config file as well. The config target is used to configure options for the kernel but should not be used until after mrproper.

11. B. The LOCALVERSION option, found within the General Setup area, can be used to append custom versioning based on your local needs.

12. C. Dynamic Kernel Module Support (dkms) is used for building kernel modules outside the kernel source tree.

13. B. The depmod command is used to create a list of modules. The list is kept in a file called modules.dep, the location of which is dependent on the distribution of Linux in use.

14. D. The udevadm command is used to work with the udev interface to the kernel, and the monitor subcommand displays kernel uevents and other udev events in real time.

15. A. The lsusb command displays information about the USB kernel interface. The -t option causes that display to be formatted in a tree-like structure that can be helpful for visualizing how the devices are connected to the computer.

16. A. The -a option displays all values and their current settings for sysctl. The -b option is binary and displays values without any newlines. The -d option is an alias for -h, which is help display. There is no -c option.

17. B. The modprobe command examines dependencies for a given module and loads both the dependencies and the requested module.

18. B. The deb-pkg target creates .deb files that are then suitable for management through the Debian package management system. Similar targets are available on other systems, such as rpm-pkg for Red Hat and CentOS systems.

19. B. The uname command is used for this purpose, and the -r option displays the kernel version number.

20. C. Information for sysctl is found within /proc/sys. Within that directory is a hierarchy of directories eventually leading to a normal file, the contents of which are the value for the variable.

21. C. Rules related to udev are stored in /etc/udev/rules.d. The /etc/udev hierarchy contains the udev.conf configuration file along with other components related to the configuration of udev.

22. A. The modinfo command provides information on a given kernel module. You can use modinfo to find out the parameters needed for a given module and the modules on which it depends, among other information. The modprobe command is used to load a module. There is no tracemod or modlist command.

23. C. Within /usr/src/linux/Documentation you will find extensive documentation on the kernel source code, including instructions on how to compile the kernel as well as the various elements found within the kernel itself.

24. B. The -k option shows the kernel driver associated with a given PCI device, and it can also be helpful when planning a new kernel compile. The -t option displays information in a tree-like structure, and -n uses numbers instead of device names. There is no -a option.

25. C. The insmod command inserts a module into the running kernel. It does not, however, attempt to resolve dependencies but rather outputs an error if there are dependent modules or kernel symbols that are not available.

26. B. The -r option removes the named kernel modules and attempts to remove any modules on which the named module depends, where possible. The -d option sets the root directory for modules, while -v is verbose and -f forces the module to load.

27. B. The modules_install make target is used to install modules that have been previously compiled using the modules target. The instmod and modinst targets are not valid.

28. B. The /etc/modprobe.d directory is used for storing configuration information related to modules such as that used for blacklisting purposes but also for other configuration information such as udev and module options.

29. C. The lsmod command displays a list of currently loaded modules. Included in the list is the size of the module in memory and what, if anything, is currently using the module.

30. B. The dracut command is used to create the initial RAM disk for newer systems and has replaced the legacy mkinitrd command used for the same purpose.

31. B. The rmmod command removes modules from a running system. In order to use rmmod, the module cannot be in use or depended on by other currently loaded modules. The other commands shown are not valid.

32. B. Variables and values placed in /etc/sysctl.conf will take effect on boot. The other files listed are not valid.

33. D. The file /proc/kallsyms provides a way to view the currently loaded kernel symbols. This can be helpful for resolving module dependencies. Note that on legacy systems, this file might be called /proc/ksyms.

34. B. The –show-depends option displays the dependencies for a given module. The other options are not valid for the modprobe command.

35. A. The systool utility can be used to show currently loaded options for a given module. The modinfo -r command is not valid, and while modinfo shows information about a module, it does not include core size and other settings. The lsmod command cannot be used for this purpose, and there is no infmod command.

36. B. The /proc/sys/kernel hierarchy contains vital configuration information for a kernel. These settings can be changed on a running system.

37. C. The kernel ring buffer, or log messages related to the kernel, can be viewed using the dmesg command. The messages normally rotate displaying the latest messages only, but this can be changed through configuration options.

Chapter 13: System Startup (Topic 202)
1. B. The /etc/systemd/system directory is the recommended location to store unit files for systemd. The other locations are not valid.

2. C. The systemctl command is used for this purpose and then with the daemon-reload subcommand. The reboot option would work to reload the systemd configuration but is not correct because it requires the entire server to reboot, which is not what this question asked.

3. B. The /etc/inittab file contains the various runlevels and what to run at the given runlevel. For example, runlevel 1 is single user, runlevel 6 is reboot, and so on. The other files listed do not exist.

4. B. The SYSLINUX bootloader is used for FAT filesystems to create rescue disks and to assist with the installation of Linux in general. Syslinux also describes an overall project containing other specialty bootloaders. The other options listed for this question are not valid bootloaders, though.

5. A. ESP uses the legacy FAT filesystem type for its underlying format. There is a specification for how the ESP partition must be created on top of the FAT format for bootloaders and kernel images. Note that the partition is typically FAT32, but it can be FAT16 if only Linux systems will reside on the drive.

6. C. initrd is used for an initial root filesystem for early drivers. initrd is configured to load within the grub configuration file for a given operating system.

7. B. The fsck command is used to diagnose and repair hard drive problems in Linux. The defrag command is not available in Linux.

8. D. The telinit command can be used for this purpose, and passing 1 as the argument will switch the system into single-user mode. The other commands shown are not valid.

9. A. The –install option is used followed by the partition to which extlinux will be installed for boot.

10. C. The format for the mount command is [partition] [target], thereby making option C correct. The other options are not valid because the arguments are in the wrong order.

11. B. The command to install GRUB is grub-install, and the first SATA drive is /dev/sda. A device listed as hda is typically a PATA drive, thereby making those options incorrect.

12. D. The -n option changes the boot order for the next boot only and boots from the specified partition. The -b along with -B modifies and then deletes the option. The -o option sets the boot order. The -c option creates a boot number.

13. A. ISOLINUX provides a means by which CD-ROMs formatted as ISO 9660 can be booted. It’s very common to have live CDs or rescue/recovery CDs that use ISOLINUX for boot. The other bootloaders are not valid for this purpose or don’t exist.

14. A. The /usr/lib/systemd hierarchy contains files related to systemd configuration. The user directory within the hierarchy is used for user unit files, and the system files are stored in /usr/lib/systemd/system.

15. B. Due to the decidedly insecure decisions made with the design of Microsoft’s UEFI, a shim is often needed to enable Linux to boot on a system with UEFI. The file shim.efi can be used as an initial bootloader for this purpose.

16. A. Priority order for systemd configuration files are those within the /etc hierarchy, followed by files in the /run hierarchy, and then followed by files in the /lib hierarchy.

17. D. Scripts for starting and stopping services are located in /etc/init.d on a SysV init-based system. The other directories listed within this option are not valid.

18. C. The systemd-delta command is used to determine overridden configuration files. Of the other commands, diff is valid, but not for this purpose. The systemctl command is also valid, but again not for the purpose described.

19. B. The chkconfig –list command displays all services that will be executed on boot along with the setting for each service for each runlevel. Of the other commands, the init command is valid, but it does not have a –bootlist option. The other commands are invalid.

20. B. The bcfg command within the UEFI shell is used to configure bootloaders on a UEFI-based system. The command can accept various parameters to configure how the bootloader and kernel will load on boot. Of the other commands shown, grub-install is valid but not within the UEFI shell.

21. B. The Master Boot Record, or MBR, is the first sector on a disk, and it contains information about the structure of the disk. If the MBR becomes corrupt, all data on the disk may be lost. The other options shown for this question are not valid.

22. A. The bootloader is mounted into /boot/efi. The other directories do not exist.

23. D. The rescue.target is used to assist in recovery by loading a minimal base system and then going to a shell akin to single-user mode or runlevel 1.

24. A. The configuration file is called isolinux.cfg, and it is typically located in /boot/isolinux or /isolinux. The other options shown are not valid filenames for this question.

25. D. The file pxelinux.0 must exist within /tftpboot on the TFTP server in order for a system to use PXELINUX for booting. The other files are not valid or necessary for ­PXELINUX.

26. D. The update-rc.d utility can be used to manage SysV init scripts on Debian or Ubuntu and other distributions. When using update-rc.d, you supply the script name and the utility will take care of creating symlinks to the appropriate runlevels.

27. B. The e key, when pressed at the right time during boot, will send you into the GRUB shell, where you can change parameters related to boot such as the kernel options and other related parameters.

28. B. The systemctl command is used for this purpose, and the get-default subcommand will display the default target for boot. On many distributions, the default target is ­graphical.target. The other subcommands shown for this question are not valid.

29. A. The -r option repairs the filesystem, while the -y option causes fsck to assume “yes” instead of prompting. The -v option is verbosity. There is no -m or -x option for fsck.

30. D. The –boot-directory option enables you to specify an alternate location for GRUB images rather than the default /boot. The other options shown for this question are not valid.

31. D. The isolate subcommand followed by the desired target is used to switch between runlevels with a systemd-based system. The other subcommands shown are not valid for systemctl.

32. C. The runlevel defined as initdefault is the default runlevel for the system. The other options shown do not exist.

33. B. The initramfs system is used instead of initrd to create the filesystem-based loading process for key drivers that are needed for boot.

34. A. The systemctl command is used for this purpose, and the set-default subcommand is necessary to affect the desired behavior. The target file is simply called multi-user.target.

35. C. The shim.efi bootloader loads another bootloader, which is grubx64.efi by default. The other options are not valid filenames for the purpose described.

36. D. The /etc/rc.d hierarchy contains symbolic links to files found within /etc/init.d. These symlinks are then used for executing the scripts at the appropriate runlevel. For example, on boot the system will execute the scripts found in the runlevel directory for each runlevel executed at boot time.

37. A. default.target is the default target unit that is activated by systemd on boot. The default target then starts other services based on the dependencies.

Chapter 14: Filesystems and Devices (Topic 203)
1. D. The file /etc/mtab lists the currently mounted filesystems. The /etc/fstab file lists overall filesystems for the computer, but it does not distinguish between mounted or unmounted filesystems. The other options listed for this question do not exist.

2. C. The -t option sets the filesystem type as ext2, ext3, or ext4. The mke2fs command is typically symlinked from /sbin/mkfs.ext2, /sbin/mkfs.ext3, and /sbin/mkfs.ext4. The -f option forces mke2fs to create a filesystem. The -a and -e options do not exist.

3. B. The file /etc/auto.master contains the configuration for autofs. The other files listed as options are not valid for this scenario.

4. C. The mkisofs command creates an ISO filesystem, which can then be written to a CD or DVD. The other commands listed are not valid.

5. A. The cryptsetup command is used to set up and help configure dm-crypt volumes. The other commands shown for this question are not valid.

6. B. The mkswap command is used to format a swap partition. The other commands are not valid.

7. B. The -c option sets the maximum mount count. The -C option sets the current number of mounts. The -b and -a options do not exist.

8. D. The -f option, also known as fake, is helpful for situations where you need to debug the mount process or when you need to add an entry into /etc/mtab for a previously mounted filesystem. The -l option shows labels, and -v is verbose. There is no -q option.

9. C. The letters ro indicate that the filesystem has been mounted read-only, meaning that it is not possible to perform a write to the filesystem. The other possible option is rw, indicating that the filesystem has been mounted as read-write.

10. C. Bad blocks are shown with the -b option. The -f option forces dumpe2fs to perform the requested operation, and the other command options do not exist.

11. D. btrfs is based on the copy-on-write principle, and it is generally considered more advanced than ext4 and its predecessors. FAT is a legacy filesystem primarily used for DOS and its follow-ons, like Windows.

12. B. The xfs_info command, which is functionally equivalent to xfs_grow -n, displays information about an XFS-formatted filesystem.

13. A. The blkid command shows information about partitions including their type, their UUID, and other basic information. The other commands shown for options do not exist.

14. C. The -t option, which can accept a comma-separated list of types, specifies that only filesystems of the listed type are to be unmounted. This is useful in conjunction with the -a option, which unmounts all filesystems except /proc. The -v option is verbose and -f forces the operation to continue.

15. D. The sync command writes unwritten data to the disk immediately, and it is useful to run just prior to attempting an unmount operation.

16. B. The swapon command enables swap space, making it available for use as virtual memory. The mkswap command formats the space. The other two commands are not valid.

17. C. The -f option specifies that xfs_check should check the contents of the named file for consistency. The -v option sets verbosity, and there is no -d or -a option.

18. B. The -w option causes debugfs to open the filesystem in read-write mode. There is also a -c option to open in catastrophic mode for filesystems with significant damage. The -rw, -r, and -n options are not valid.

19. D. The smartd daemon monitors SMART-compatible disks for notable events, and it can be configured to send alerts when events occur. The other commands listed are not valid for this scenario.

20. A. The -f option forces fsck to run on an otherwise clean filesystem. This can be helpful for times when you suspect that there is an error on the filesystem, and you need to verify this as part of the troubleshooting process. This can also be helpful to prepare the filesystem for conversion, such as might be the case with a tool like btrfs-convert.

21. A. The block size for import or restore must match the block size used on export or dump. Block size is specified with the -b option, thus making option A correct. The other options are not valid for xfsrestore.

22. B. A filesystem with the word defaults for its mount options will be mounted read-write (rw), suid, with the ability to have executables (exec). The filesystem will be auto-mounted (auto), but users will not be able to mount it (nouser). Character and block special devices will be interpreted (dev), and operations on the disk will be performed in an asynchronous manner (async).

23. D. The smartctl command controls how SMART monitoring is done for a given device, assuming that the smartmon utilities have been installed. The smartd option represents the overall daemon for monitoring SMART events.

24. A. Within /etc/fstab, the filesystem to be mounted (such as /dev/sda1) is found first, followed by the destination location to which the filesystem will be mounted. The type of filesystem follows next, along with any options needed for the filesystem. The dump utility indicator follows the options, and finally the pass or fsck order is last. The last field determines the order in which filesystems are checked by fsck on boot.

25. A. Password-based Key Derivation Function 2 (PBKDF2) is used for key derivation for the password-based cryptography used with LUKS. SSL is Secure Sockets Layer, and it is typically used for encryption of HTTP traffic. Both RSA and DSA are encryption algorithms, but they are not related to this question.

26. B. The btrfs subvolume create command creates a btrfs subvolume. The other ­commands are not valid.

27. C. The -z option sets the maximum size for files to be included in the dump. The -b option sets the block size, but it is not related to what is being asked for in this scenario. The -s option sets the path for inclusion in the dump, and -p sets the interval for progress ­indicators.

28. C. The -e option sets the behavior, such as continue, remount read-only, or panic when an error occurs at the filesystem level. The -f option forces whatever operation you’re requesting to continue, even if there are errors. The -d and -k options are not valid.

29. D. The -n option causes mount not to write to /etc/mtab, and it is particularly useful for the scenario described. The -a option mounts all filesystems in /etc/fstab. There is no -b or -m option.

30. A. The swapoff command deactivates swap space, thereby making it unavailable as virtual memory on the system. The other commands shown as options are not valid.

31. A. The Where= directive specifies the location for the final mounted filesystem.

32. C. The –show option displays information about the swap spaces on the computer, including how much swap space is currently being used. The -a option activates all swap spaces. There is no –list option and -h displays help.

33. A. The mkfs.fat or mkfs.vfat commands are valid for creation of FAT filesystems. There is no -f option to mkfs and there is no mkfat command.

34. D. The tune2fs command is used for working with ext2, ext3, and ext4 filesystems. The -j option adds a journal. The other commands are not valid.

35. A. The snapshot subcommand of btrfs subvolume creates a snapshot. The other commands shown are not valid.

36. A. The -L option forces the log to be cleared or zeroed out, which may cause a loss of data. The -v option sets verbose output, while -V prints the version. The -d option performs a dangerous repair, which can be used on a read-only filesystem.

37. C. The -o option enables the setting of one or more options for the mount command and ro is read-only. Note that the -r option will also mount as read-only. The other options shown are not valid.

Chapter 15: Advanced Storage Device Administration (Topic 204)

1. B. The file /etc/mdadm.conf is the configuration file used for RAID setups that use md. The other files listed are not valid.

2. D. A partition type 0xFD is used for software RAID arrays. This can be set or viewed using a tool such as fdisk. The other options shown are not valid partition types.

3. C. The /dev/disk/by-id directory contains symbolic links to /dev/sd, such as /dev/sda. Because WWIDs can be used to identify a device across systems, 
      they are often used within the context of SANs. The other directories listed as options do not exist.

4. A. The iscsiadm command is used for administration of iSCSI devices on a Linux system. The other options shown for this question are not valid.

5. C. The pvdisplay command shows information about a given physical volume. You can use pvdisplay to view the device on which the PV is built along with the extent size of the PV. The other commands shown are not valid.

6. D. The DEVICE configuration line contains a list of devices that can be used for an array. The keyword DEVICE is then followed by a space-separated list of devices.

7. B. Logical unit numbers (LUNs) that contain the characters fc are those found through Fibre Channel. Therein lies the difference between options B and C, 
      where option C contains the letters scsi, which would usually represent a local disk. The other options are not valid.

8. C. The multipath command is used for administration of devices such as LUNs and can be used for finding the path to LUNs for a server, such as in a SAN configuration. 
       The other commands are not valid, with the exception of ls, which is valid; however, the option shown is not related to LUNs but rather to a combination of various flags to the ls ­command.

9. C. The fstrim command is used to remove blocks that are not in use. The fstrim command is frequently used in a SAN configuration to give back unused storage to the SAN. The fstrim command can also be used with solid-state drives for the same purpose. The other commands shown are not valid.

10. B. NVMe-capable drives are named /dev/nvme*. No special drivers are needed other than those found in the native kernel on a modern system. The other answers do not exist as paths by default.

11. A. The scsi_id command generates a SCSI identifier based on page 0x80 or 0x83 of the vital product data on a device. The other commands are not valid.

12. D. AOE, or ATA over Ethernet, sends ATA commands directly over Ethernet. AOE commands are sent at a lower layer of the OSI model than TCP/IP or even IP, but they are not routable. 
       The other acronyms shown are valid but not for the purpose described. 
       PXE is a boot protocol, 
       POE is used for power over Ethernet, and 
       iSCSI is a storage protocol, though not related to ATA.

13. B. The hdparm command can be used to get or set values related to the low-level configuration of drive settings for both IDE and SATA devices. The other commands shown for this question are not valid.

14. A. The next step is typically to create a volume group (or more than one) with vgcreate based on the newly created physical volumes.

15. B. The -E option signals that an extended option follows, such as stripe_width. 
       The -f option forces an operation but should not be necessary for this solution, and 
       the -e option sets the behavior on error. There is no -extend option.

16. D. The file /proc/mdstat contains information on RAID arrays including RAID personalities found on the system, 
       the devices that compose the array, and other pertinent information. The other files shown are not valid.

17. A. The iscsid daemon creates and maintains connections to iSCSI targets, making them available in Linux. 
       The iscsiadm command is used for administrative purposes, and the other commands shown are not valid.

18. C. The nvme module, available on modern systems, is used as a driver for NVMe devices on Linux. You can examine the nvme module with the modinfo command.

19. B. The directory /sys/class/fc_host contains other directories based on the Fibre Channel connections available. Within those host directories will be found the WWN (World Wide Name) in a file called port_name. The other directory hierarchies are not valid.

20. A. The –create option enables creation of a RAID array that will use md. The typical argument is the /dev/mdN device. The other options listed are not valid for mdadm.

21. B. The file iscsid.conf, typically found in either /etc/ or /etc/iscsid/, is used for configuration related to the iscsi daemon. The other configuration files are not valid for iscsid.

22. C. The /dev/mapper directory contains information about multipath devices such as logical volumes. The other directories are not valid.

23. C. The –monitor option is used to actively watch an array for issues such as disk failure. The monitoring can be done as a daemon and run in the background, thereby alerting when there is an issue.

24. A. The -o ro option mounts the drive in read-only mode. The rw mode is read-write. Mounting in read-only is useful if you need to diagnose the drive without potentially destroying any information on the drive. The other options are not valid.

25. B. The lvcreate command is used to create a logical volume from previously created physical devices and volume groups. Using lvcreate is the final of three steps in the process for using LVM prior to actually using the logical volume.

26. B. The MAILADDR option sets the destination address for mail about RAID events that are noted by mdadm when in monitor mode.

27. A. The vgscan command looks for both physical volumes and volume groups related to an LVM configuration. The vgscan command is run at system startup, but it can also be run manually. The other commands are not valid.

28. D. A partition type of 0xFD is used for software RAID arrays. This can be set or viewed using a tool such as fdisk. The other options shown are not valid partition types.

29. C. The pvscan command displays a list of physical volumes on a given server. The PVs displayed are those that have been initialized with pvcreate for use with LVM.

30. B. The interactive console is accessed by calling multipathd with the -k option. Once in the console, you can obtain help by typing help. The other options shown are not valid for multipathd.

31. A. The -a or –available (sometimes known as –activate) option sets whether the logical volume can be used. There is no -b -or -c option, and the -d option is used for debugging.

32. A. The file lvm.conf is a primary configuration file for LVM. Within lvm.conf, typically found in /etc/ or /etc/lvm/, you can set things like filters for devices to include or exclude from the vgscan process. The other commands shown are not valid.

33. B. The snapshot option creates a snapshot of a logical volume. The other options shown are not valid.

34. C. The -w option writes a new value to the given kernel parameter. The -a and -A options both list all values. There is no -k option.

35. D. The sdparm command is similar to the hdparm command. Whereas hdparm is used for IDE and SATA, sdparm is used for SCSI devices. The other commands shown are not valid.

36. A. The directory /etc/fcoe contains information related to the FCoE configuration on a given system. The other directories are not valid for FCoE.

37. D. The lspci command is used for this purpose. NVME devices are listed with the name nVME or NVMe; therefore, adding -i to grep will make the search case insensitive. You’d use this in order to ensure that the devices are detected. The other commands are not valid, with the exception of the lspci command, but you cannot grep for scsi for this scenario.

Chapter 16: Networking Configuration (Topic 205)
1. C. The ip command defaults to the INET family if not otherwise specified with the -f option. The command attempts to guess the correct family and falls back to INET. The other families listed as options for this command are not valid for use with the ip ­command.

2. B. The ifconfig command is used for this purpose, followed by the interface. The hw keyword is used for the hardware address, which is then followed by the hardware class, in this case ether. That is followed by the new MAC address (not depicted in the options). The other commands are not valid.

3. D. The -n option causes route to use numeric values only, performing no name resolution. This option is useful for the scenario described. The -e option causes the output to be in netstat format. There is no -d or -f option for the route command.

4. A. Because you’re working with MAC addresses, the arp command will be used. The -d option removes or deletes an ARP entry, which would be appropriate here so that the MAC address resolution occurs again. The netstat command is not used for this purpose. The hostname and dig commands work with name resolution but not for MAC addresses or the ARP table.

5. A. The iw command is used for this purpose. When you’re using iw with a specific device, the dev keyword appears next followed by the device name. Finally, the command to execute on that device, in this case the link command, is used.

6. B. The iwconfig command, which is similar to the ifconfig command, works with an individual wireless interface to set and display parameters. Of the other commands, the ifconfig command is valid but not used for wireless. The other commands are not valid.

7. C. The iwlist command can be used for this purpose, and the scan subcommand is used to look for local access points and wireless networks. The iwconfig command does not have a scan subcommand. Likewise, there is no subcommand called get for the iwlist command, and there is no iw-scan command.

8. B. The -o option removes newlines from the output, thereby making the output more suitable for the grep command. The -l option specifies the number of loops for the ip addr flush command; The -f option specifies the protocol family. There is no -n option.

9. B. The mtu option can be used to set the value for the maximum transmission unit (MTU) for a given interface. The metric option sets the interface metric. The other options are not valid.

10. B. A route will need to be added in order to utilize the reject destination, thereby making option B correct. Option C deletes the route but does not create a reject route. Option D deletes the default route, and option A is not valid.

11. A. The -s option creates an ARP table entry. The -d option removes an entry. The -c and –add options do not exist.

12. A. The ss command provides many of the same functions as netstat, but it can show some extended information, such as memory allocation for a given socket. The free command shows memory usage but not by socket. The other two commands do not exist.

13. D. The -t option shows TCP connections, while -a shows active sockets. The -n option disables name resolution.

14. C. This solution requires a way to filter out the bind user; therefore, answers that grep for bind or specify bind as the user are incorrect. However, the lsof command allows for negation with the caret ^ character. Therefore, listing all files except bind requires the syntax shown.

15. D. The -f option is a flood ping. This will effectively cause the interface to send and receive large amounts of traffic, usually making it easier to find on a switch. The -a option is an audible ping, emitting a sound on ping. The -c option sends a certain count of pings. There is no -e option.

16. B. The netcat command provides a method for opening and communicating on both sides, server and client, for a TCP connection. The netcat command avoids some of the issues with Telnet capturing characters specific to the Telnet protocol. The netstat command does not test connectivity, and ping does not do so at the TCP level. There is no nettest command.

17. C. The -D option lists the interfaces on a given computer. The -d option dumps compiled matching code, and -i selects an interface. There is no -a option.

18. B. The -R option requires that an attempt at name resolution be performed. The -n option does the opposite; that is, it disables name resolution. There is no -b or -a option.

19. A. The ping6 command performs the same as the IPv4 ping command, but it does so for IPv6. The other commands are not valid on Linux.

20. B. The ip command can be used for this purpose. When used with the addr object and the -6 option, only information about IPv6 addresses will be shown. The first option, simply ip addr, will show all addresses including IPv4. The other commands are not valid.

21. A. The ifconfig command is used for this purpose, and ARP can be disabled by preceding the word arp with a minus sign, as shown. If no minus sign is present, then ARP will be enabled. The other commands will not work for this scenario.

22. C. The dev option specifies the device to use for the route being specified. This is a typical use case for many routes to reduce the chances of the kernel guessing incorrectly. The other options shown for this question are not valid.

23. C. The -p option shows the process IDs associated with a given socket within the ss output. The -a option is for all sockets, while -l is for listening sockets. The -f option is used to specify the protocol family.

24. A. The -i option shows interface information in a table-like format. Information such as transmit and receive bytes as well as the MTU for the interface and other information is shown. The -r option shows routes, while -l shows listening sockets. There is no -t option.

25. D. The /etc/network directory contains information on network interfaces and contains directories that further contain scripts to be executed when interfaces are brought up or down. The other directories listed do not exist.

26. C. The -I option tells traceroute to use ICMP for requests. The -T option is TCP SYN. The -A option performs AS path lookups, and the -i option configures traceroute to use the specified interface.

27. B. The mtr command provides a unique way to view real-time information about each hop in a route between hosts. Both the traceroute and route commands are valid, but the options shown for each are not. There is no liveroute command.

28. C. Internally, the hostname command uses gethostname. This can be useful to know when troubleshooting address resolution issues such as conflicting results for host naming. The other functions are not valid.

29. A. The grep command and the -i option should be used in order to make the grep case-insensitive. When used with -v, grep will exclude the argument, thus doing the opposite of what’s needed here. The kernel ring buffer will probably not contain information about DHCP, therefore making dmesg not the correct option.

30. B. Only alphanumerics, minus/dash, and dot are valid for hosts in /etc/hosts.

31. B. Options within /etc/resolv.conf are preceded with the options keyword followed by one or more options such as debug.

32. B. The -c option clears the kernel ring buffer after the first read. The -C option clears it immediately. The -e option displays relative time and local time. There is no -a option.

33. D. The systemctl command is used for this purpose. Adding the -u option specifies the unit for which journal entries are desired.

34. A. The /etc/hostname file typically contains only the hostname of the local computer rather than the hostname and domain name. This is then read at boot time to set the hostname for the computer. The /etc/hosts file contains information on various hosts for name resolution purposes. The other files do not exist.

35. C. The /etc/sysconfig/network-scripts directory contains configuration information for a Red Hat system. The other directories shown do not exist.

36. B. The traceroute6 command is used for tracing IPv6 routes. The other commands do not exist.

37. C. The PARANOID wildcard specifies that the hostname and IP must match. The ALL keyword is also a valid wildcard in TCP Wrappers for use in both /etc/hosts.allow and /etc/hosts.deny.

Chapter 17: System Maintenance (Topic 206)
1. C. The kernel sources now use xz compression. Previously, these sources had used bzip2, and prior to that they used gzip. There is no xy compression algorithm.

2. C. The -a option provides archive mode, which is a substitute for several other options. The -r option is recursive, the -o option indicates that ownership should be preserved, and the -f option enables a filter.

3. A. The -c option indicates the creation of a tar file. The -d option is used for diffing or differencing between two tar files, the -b option provides block size, and -f specifies the file for use with tar.

4. C. The –remove-files option removes files from the filesystem after adding them to the archive. The -r option appends files to the end of an archive, the -d option provides a diff between the filesystem and an archive, and the -f option specifies the file.

5. D. The -p option specifies the number of slashes to be stripped from the beginning of the path for patching. Both the -p1 and -p0 options are quite common. The -s option specifies silent operation. There is no -strip option.

6. A. According to the man(1) page for the make command, the name Makefile, with an uppercase M, is the recommended name for the file. The name makefile is valid as a default, but it is not the recommended option. The other files are not valid as default names.

7. D. The clean target is typically included in most Makefiles for projects in order to remove files leftover from a previous compilation. The other targets are not valid.

8. D. The configure script, which is usually included in source code packages, customizes the software based on the local environment. The other script names shown are generally not used.

9. B. The /usr/src directory is the recommended location for source code according to the Filesystem Hierarchy Standard. Many administrators use /usr/local/src instead, but this is not specified in the FHS.

10. B. The gunzip command is used to uncompress files that have been compressed using gzip compression.

11. C. The bs option is used to specify block size. Various suffixes are possible such as M, which is equivalent to megabytes, and K, which is equivalent to kilobytes.

12. C. The tapetype directive defines a friendly name for a destination. The destination is then further configured within a corresponding define directive. The other directives are not valid for Amanda.

13. D. Tape devices are found within /dev/st*, thereby making st0 the first device.

14. C. The /etc/issue file is used to provide a message to users, such as a login banner, prior to local login. The other files shown are not valid for the purpose described.

15. A. The –delete option removes files that no longer exist on the host system when syncing with archive mode in rsync. The other options shown are not valid for rsync.

16. D. The wall command displays a message to all logged-in users. The command is sometimes used to communicate an impending reboot or shutdown of the server. The other commands shown are not valid.

17. B. The –exclude option excludes files matching a pattern from the archive. This option can greatly reduce the size of an archive by excluding unnecessary files from the archive. The -x option is the only other valid option that extracts files from an archive.

18. C. The contents of the file motd, an abbreviation for Message of the Day, are displayed when a user logs in successfully. Among the other options, the contents of /etc/issue are displayed prior to local login. The other filenames are not valid for this purpose.

19. B. The -f option specifies the filename and -v is verbose, making both of those options required based on the scenario. The -x option extracts from the archive.

20. C. Executing the configure script from the current directory typically means prefacing the script name with ./, as shown in the correct option.

21. A. The -z option will uncompress a tar file that has been compressed with gzip. The -x option extracts, while -c creates a tar file. Finally, -f specifies the tar file to work with.

22. B. The file /etc/issue.net is used to provide a message for remote logins such as Telnet. The other files listed are not valid for the purpose described.

23. D. The poweroff target of systemd, accessed using the systemctl command, is used for halting the system and then attempting to remove power on compatible systems. The halt target stops the system but does not attempt to remove power, while reboot simply restarts the system. There is no stop target.

24. A. The uname command displays information about the kernel, processor type, and other relevant components that might be helpful when compiling software.

25. D. The –modify-window option modifies how file synchronization is determined. The default behavior is to match to the nearest second. This option is useful for synchronizing between filesystem types, such as Microsoft FAT, which don’t have the precision of Linux-based filesystems.

26. B. The -b option specifies that a backup should be made during the patching process. The -l option tells patch to ignore whitespace. The -r option specifies a reject file. There is no -a option.

27. D. The install target installs the final compiled files in their appropriate location and makes them executable, if applicable. Of the other options, distclean is sometimes included as a target to return source files to their pristine state. The other targets listed are not valid.

28. C. Compression using the xz program is indicated with the -J option. The -j option indicates bzip2 compression. The -x and -c options are extract and create, respectively.

29. B. The –size-only option examines whether the files being synchronized are the same size. This can be helpful for situations where there may be significant time skew or other issues preventing the normal differencing mechanisms from working properly. The other options shown are not valid for rsync.

30. A. The –decompress option uncompresses an xz file, while the –stdout option sends the output to standard out. The other options shown are not valid.

31. B. The -c option sends output to STDOUT. The -d option decompresses, while -f forces an operation. Finally, -s reduces the memory footprint for bzip2.

32. D. The Bacula Director configuration file is called /etc/bacula/bacula-dir.conf by default. The other files are not normally used as part of a Bacula configuration.

33. B. The rewind subcommand for the mt command rewinds the tape to the beginning. This subcommand can be shortened to rew instead of rewind. The other subcommands shown do not work with mt.

34. A. The -r option is needed to specify reboot and the format for counting time from now. It is prefaced with a plus sign (+), thereby making option A correct. Of the other commands, specifying +15 without the -r option simply shuts down the computer in 15 minutes, and specifying the time as 00:15, as in option D, will reboot the computer at 12:15 a.m.

35. B. The -q option suppresses all warnings. The -v option is verbose, while -L displays the license. The -r option is recursive.

36. C. The -e option, also available as –rsh=ssh, uses ssh as the means for transport, thereby ensuring an encrypted tunnel over which the synchronization process will occur. The other options shown are not valid.

37. B. The –help option is usually included with the configure script as a means to list the other available options. Because every configure script is customized for a given source code package, the other options may vary. Even –help may not always be available, depending on whether the source code author included it.

Chapter 18: Domain Name Server (Topic 207)
1. A. The file named.conf, located in /etc/ or /etc/bind/, is the default configuration file for the BIND server. The file typically loads or includes other configuration files for specific configurations.

2. B. The allow-query directive sets the hosts from which DNS queries will be allowed for the nameserver. This can be helpful for situations where there may be untrusted clients that can reach the nameserver.

3. B. The -1 or -HUP signal reloads the given process. The -15 signal is the default terminate signal, while -2 is an interrupt signal. The -9 signal is for kill, and it is considered bad practice except in emergencies when the process doesn’t respond to normal signals.

4. A. The -a option enables specification of the algorithm to use, while -n specifies the name type to use such as zone, host, or others. There is no -d or -e option.

5. B. The named-checkzone command examines a zone file for obvious syntax errors that would prevent BIND from using the file. The named-compilezone file does the same thing as named-checkzone but sends the output directly to a file instead.

6. A. The lowest priority number wins for MX records, thereby making 0 the highest priority MX record for the domain.

7. D. DNS typically uses UDP port 53, except for zone transfers, in which case TCP port 53 is used because of the size of the request for most zones.

8. A. The directory /var/named stores zones. On Debian, this directory is /var/cache/bind. The /etc/named directory is used by some distributions as a location for configuration files.

9. C. The rndc command is used to control a BIND server, including controlling it over a remote connection. The other commands shown are not valid.

10. D. The axfr type can be used with dig to request a zone transfer. The client from which you request the zone transfer will need to be authorized to initiate a transfer.

11. B. The listen-on directive sets the IP address or addresses on which the daemon will operate. The other directives are not valid.

12. C. The home directory should be set in /etc/passwd, and it should be set to the chroot directory. The other files listed are not valid.

13. A. The dnssec-signzone command is used to sign DNS zones when using DNSSEC. The other commands do not exist.

14. A. Setting -a as an option to the host command sets the query type to ANY. The -c option sets the class, and the -d option turns on debugging. There is no -b option.

15. C. The correct format for a CNAME requires a trailing dot, which represents the only difference between answers C and D.

16. A. The only option, as in forward only, is used to indicate that the server should only forward queries and not attempt to answer them directly. The first option forwards the query, and if no response is received, then it attempts to perform the query itself. The other options are not valid.

17. B. The blackhole option provides a list of addresses that will not be allowed to receive answers for queries. This can be helpful for security reasons. The other options are not valid.

18. B. The daemontools package is required in order to install djbdns. BIND9 is not typically used when djbdns is used, and qmail is not required.

19. D. The named-checkconf command is used to verify the configuration of BIND. When no configuration file is given, it is assumed that /etc/named.conf represents the configuration file.

20. C. TTL, or time to live, values are provided in seconds by default, thereby making 28,800 equal to eight hours.

21. B. The value 1800 represents the retry value for the zone. The refresh is 3600, while the default TTL is 86400. Finally, the serial is 2016070400.

22. C. TXT records are used to create resource records in support of SPF. MX is used for SMTP servers.

23. B. The mail exchanger is defined as Priority MX Hostname in the format shown.

24. C. The .digrc file, found in a user’s home directory, can be used to set defaults for use of the dig command. There is no dig configuration file found in /etc.

25. A. The –bind option for the mount command, which has nothing to do with the BIND daemon itself, enables mounting or remounting a portion of the filesystem in another ­location. This is helpful for facilitating working with BIND configuration files in a chroot environment.

26. D. The zone type of hint is used with the root zone file. When setting up a zone for which the server is authoritative, the type is master or slave. There is no recurse type.

27. A. The rndc command can be used for this purpose and, when given the reload subcommand, will reload the zones for the server.

28. D. The allow-transfer directive specifies the hosts that are allowed to request a transfer of the zone. The other options shown are not valid.

29. D. POP3 servers do not have a specific type in DNS. The MX type indicates mail exchanger, or SMTP server.

30. C. The allow-recursion option is useful for situations where certain clients can query the nameserver for its authoritative names but not request recursion.

31. A. The correct format is named-checkzone <zone> <zonefile>. No other options are required.

32. D. The only available algorithm for rndc is hmac-md5, and the key can be generated with dnssec-keygen. The other options shown are encryption or hashing algorithms but are not used for the scenario described.

33. B. The version none; directive within a BIND configuration file tells BIND not to return version information. The other directives are not valid.

34. C. The -z option tells named-checkconf to verify the master zones as part of the verification process. The other options are not valid.

35. B. An individual TTL on a record means that it will take up to that many seconds for the change to propagate. New requests will begin seeing the change immediately after restart, but external resolvers may cache for up to the TTL value before requesting another resolution.

36. A. The pdns-server package is available on Debian and pdns on Red Hat. Red Hat will require installation from EPEL.

37. B. The rndc command can be used for this purpose with the reconfig subcommand. Because the scenario includes changes to the named.conf configuration file, a simple rndc reload is not appropriate.

Chapter 19: HTTP Services (Topic 208)
1. B. The <VirtualHost> directive begins a stanza that facilitates serving websites using virtual servers. The other directives are not valid for Apache.

2. D. The htpasswd command creates or updates credentials for native Apache authentication using htaccess. The passwd command is valid, but it does not work with htaccess. The other commands are not valid.

3. C. The configtest option verifies the configuration file syntax, and it is quite helpful in order to prevent a situation where the server cannot restart due to a fatal error in the configuration. The other options are not valid for the apachectl command.

4. A. The openssl command is used for this purpose with the genrsa option. An output file is specified with -out. The other commands containing openssl all contain an invalid option, and the final command is openssh and it is not used for this scenario.

5. B. The AuthUserFile directive works with mod_auth_basic and mod_authn_file to tell Apache the location of the file that will be used for authentication.

6. C. The ServerName directive provides the hostname for the virtual server. The other directives are not used.

7. A. The SSLEngine option needs to be set to On for SSL to be enabled for a given site or server. The other options are not valid.

8. D. The index option enables the administrator to set a space-separated list of valid index files for the server, such as index.html, index.htm, and index.php. The other options listed for this question are not valid.

9. B. The acl configuration directive creates an access control list. Access control lists are powerful features of a Squid proxy setup and can include networks, MAC addresses, ports, browsers, and much more.

10. C. It can be desirable at times not to display the version of Apache in use. Some say that doing so might help security. However, this type of “security through obscurity” may not be entirely effective.

11. C. Server Name Indication, or SNI, facilitates serving multiple virtual hosts from the same IP address even when SSL is used. Without SNI, each SSL-based virtual host would require its own IP address. The other technologies are not valid for this scenario.

12. A. The SSLCACertificateFile directive enables specification of a single PEM file containing CA certificates for client authentication.

13. B. The AuthName directive sets a friendly display value that is shown within the authentication pop-up window. The other values shown do not have any effect within Apache2.

14. D. The LoadModule directive is used for this purpose and accepts the name of the module followed by its filename.

15. A. The req option begins the CSR generation process, typically also requiring -new as an additional option. The other subcommands are not valid.

16. B. The DocumentRoot directive sets the default directory from which documents are served, both inside and outside a virtual host stanza. The ServerRoot directive sets the overall root directory for the server and is not related to virtual hosts or document serving. The other two options are not valid Apache directives.

17. D. The file php.ini, typically located within the /etc/ hierarchy, depending on distribution, is used as the primary configuration file for PHP. The other files are not used by PHP.

18. C. The Options directive is used for this purpose and the option to exclude is Indexes. Options are included or excluded by a plus or minus sign, respectively. There is no option named Default.

19. A. The syntax shown will redirect the user to a 404 page in the event that they attempt to navigate to the .git directory. The other options will not work because of syntax errors.

20. B. The SSLCertificateKeyFile directive points to the location of the private key for an SSL configuration. The other options shown are not valid directives.

21. B. Squid listens on port 3128 by default. The other ports listed are valid but are not the default port for Squid.

22. C. The mod_authz_host module is used for authorization based on IP address or hostname. The other modules are not valid for a default Apache configuration for the purpose described.

23. A. The default name for the primary log file for Apache is access_log. This file may sometimes be called access.log, depending on the distribution. The name of the file along with what is recorded in the log can be customized.

24. B. The http_access directive is combined with ACL directives to define access to use the Squid proxy. The other directives are not valid for use in Squid.

25. C. The AccessFileName directive can be used to set the access filename to something other than .htaccess.

26. B. Apache explains within the documentation that higher performance is achieved by storing the directives related to user authentication within the main server configuration when possible. The only reason not to do this is so that the authentication directives are accessible by the user. There is no scenario to store user authentication configuration information in a mod_rewrite block or in a module, as was the case for two of the four options for this question.

27. D. The AuthGroupFile directive facilitates the scenario described. Users must be authenticated, and then a directory or other resource can be associated with the group file to enable users in the file to access the resource. The other directives shown are not valid.

28. B. The apachectl command can be used for this purpose, and when given the status argument will print status information for the server. The other arguments for apachectl are not valid.

29. A. A 405, Method not allowed, response will be sent when TraceEnable is off. A 100 code is continue, while 302 is redirect and 200 is OK.

30. C. The -c option creates a new file. The -b option is batch mode. The -e and -f options do not exist for htpasswd.

31. A. Log format sequences begin with a percent sign, and %D logs the time taken to service the request in microseconds. The %T sequence logs the time taken to service the request, but it requires a preceding unit of time to log. The %t sequence is the time of day when the request was received.

32. B. The Alias directive is used for this purpose. The format calls for the destination followed by the location to be aliased, thereby making option B correct. There is no Connect directive in Apache.

33. B. The SetHandler directive is used for this purpose. SetHandler should be set to perl-script for mod_perl to work. There is a LoadModule required for mod_perl, but its arguments include mod_perl and the location of the mod_perl module.

34. C. The proxy_pass directive, found within a location stanza in nginx, enables proxying of requests for that location to the specified URL. The other directives are not valid for nginx.

35. C. The StartServers directive determines the number of child processes that will start initially. This number will change as requests are received, especially simultaneous requests. On busy servers, the StartServers directive may need to be increased, as will other related directives to ensure adequate performance.

36. D. The LogFormat directive sets the parameters that are stored in a log file. The LogFormat directive sets up a logging profile that can then be used elsewhere within the configuration. The other options are not valid.

37. C. The Require directive is used for this, and when requiring a specific user, the directive is followed by the keyword user and then the user to allow. The other directives shown are not valid for Apache.

Chapter 20: File Sharing (Topic 209)
1. B. The configuration files for Samba are located in /etc/samba. The directory is not named for a specific version of Samba. The other directories listed do not exist by default.

2. B. The nmbd daemon is responsible for NetBIOS name service request handling. The smbd daemon is responsible for file and print sharing and winbindd provides user and group information. There is no daemon called samba.

3. D. The smbcontrol command can be used to send messages to smbd, nmbd, or winbindd. When using the destination of all, the message will be sent to all three daemons. There are several message types that can be sent with smbcontrol, one of which is reload-config. There is a shutdown message, but that would be disruptive to users and would not reload the configs until restart.

4. D. The file /etc/exports contains definitions of filesystems to be shared using NFS. The other files are not valid for use with NFS.

5. A. Spacing is important within an NFS export configuration. This is the primary difference between option A and option C, regarding a space between the hostname and the (rw) configuration directive. With option A, where there is no space, www.example.com is allowed read-write access to the share. With option C, where there is a space, www.example.com is allowed only read access while everyone else is allowed read-write.

6. B. The -k option enables Kerberos authentication for the net command. The -a option indicates that non-interactive mode should be used, and -l sets the log directory. There is no -b option.

7. D. The username map option, which is set to a file containing the username mappings, is used to provide translation between a Windows username and the username on Linux for each user. The other options shown are not valid in a Samba configuration.

8. C. A percent sign (%) is used to separate the username from the password, as in this example with a username of Administrator and a password of adminpass: -U Administrator%adminpass.

9. C. Wildcards are specified with a * or ? for NFS; therefore *.example.org indicates that all hosts directly under example.org can connect. Note that the wildcard match is not hierarchical, meaning that subdomains underneath *.example.org are not included (www.chicago.example.org, for example).

10. D. The cifs filesystem type is used for mounting Samba shares. The vfat filesystem is used to mount native Windows filesystems, and ext4 is a native Linux filesystem. There is no win type.

11. C. The mount command can be used for this purpose, and when given the -t cifs argument it will show all mounted CIFS filesystems. There is no smb filesystem type, and the ls command with -cifs options will display various file listings but none specific to the CIFS filesystem.

12. D. Setting the security parameter to share indicates that share-level security will be used. The parameter is set as in security = share. The other options shown for this question are not valid.

13. B. The -m option to rpcinfo displays statistics for rpcbind. The -s and -l options are used to display lists of programs and entries for the specific program. There is no -e option for rpcinfo.

14. B. The showmount command is used for this purpose, and when given the -e option it displays the exports for the server. Among the other options, the mount command is valid but not with the given options.

15. C. The /etc/fstab file utilizes a specific format calling for the filesystem device, in this case src.example.com:/source, followed by the mount destination, in this case /srv/source, and then followed by the filesystem type. For this scenario, the filesystem type is nfs. Options for the filesystem along with default mount order are typically also included in /etc/fstab.

16. A. The -3 option shows only NFSv3 statistics. There are also corresponding -2 and -4 options for NFSv2 and NFSv4, respectively. The other options shown do not exist.

17. B. The /proc/mounts file shows currently mounted filesystems. The /etc/fstab file shows filesystems that could be mounted but may not currently be mounted. The other files shown are not valid.

18. A. When used with TCP Wrappers, as in hosts.allow and hosts.deny, the portmap service must use IP addresses. Therefore, option A is correct.

19. B. The -L option displays a list of locks. The -l option sets the base directory for logging. There is no -o or -m option for smbstatus.

20. B. The smbpasswd command is used for management of Samba credentials. When given the -a option, a new user is created. Of the other commands, the passwd command is valid but does not have a -samba option. The other commands are not valid.

21. A. The browsable option, set to yes or no, configures whether a given share can be seen by browsing. When set to no, users must know the share name in order to interact with it.

22. D. The dbcheck command for samba-tool verifies the location of the Active Directory database. The other commands are not used with samba-tool.

23. C. The [global] section of the Samba configuration file enables setting of the log file. The other sections shown are not valid.

24. C. The testparm command can be used to verify the syntax within Samba configuration files. The other commands shown are not valid.

25. B. The exportfs command is used for several administrative tasks related to NFS. When given the -ra option, the /etc/exports file is reread, a new export list is created, and the shares are created.

26. A. The -R option specifies the resolve order for names used with smbclient. For example, setting the value of the -R option to wins specifies that the WINS server should be used for name resolution. The -d option specifies the debug level.

27. C. The -l option logs all successful mountd requests. Of the other options, the -n option allows non-root requests, and -r allows regular files to be served through RPC requests.

28. B. The read only option, set to yes or no, defines whether users connecting to a given share can perform read/write operations on the share. The other options shown are not valid for Samba.

29. C. The smbd daemon listens on TCP ports 139 and 445. Port 443 is used for HTTPS, and ports 161 and 162 are used for SNMP.

30. C. The root_squash option changes the privileges of root when using an NFS share from a remote client. The root user will have the lowest privileges possible. The other options are not valid for NFS.

31. B. The net command is used for this solution, and when given the groupmap list subcommand and option, a mapping of Windows to Linux groups will be shown. The other commands are not valid.

32. A. The -p option shows current portmappings for the various RPC-related services on the host. The -m option shows statistics. There is no -c or -f option for rpcinfo.

33. B. The -x option deletes a user from the Samba user database. The -d option disables the account. The -e option enables the account. There is no -o option.

34. C. The smbclient command can be used for this purpose, and when given the -L option and a hostname, the command will show the services available on that host. The other commands shown are not valid.

35. C. The configuration shown, with %S.log, will create a separate log file for each share. All of the other options contain syntax errors that make them invalid for the Samba configuration file.

36. D. The nmblookup command can be used to test NetBIOS-related services on a network.

37. D. The exportfs command with the -u and -a options unexports all directories. Another way to accomplish this task would be to stop the NFS daemons, but that option was not given among the choices.

Chapter 21: Network Client Management (Topic 210)
1. A. The ddns-update-style option configures whether a server performs a DNS update when leases are created or confirmed. The other options are not valid for use with DHCP.

2. A. The subnet keyword is used for this purpose as well as a netmask parameter. The netmask shown will provide 126 usable addresses.

3. B. The hardware ethernet directive is used to specify the MAC address for a given host to which the reservation will be tied. The other options are not used within DHCP.

4. C. The directory /etc/pam.d stores configuration files for individual PAM-aware services. Each service typically has its own file that is managed for that service according to its usage of PAM. Of the other options, none of the directories are the default directories used for PAM.

5. A. The standard port for LDAP is 389, and that is the port on which slapd listens for connections. Port 3389 is RDP, while 3306 is MySQL. Finally, 110 is POP3.

6. D. The ldapadd command is used to add entries into the OpenLDAP database.

7. C. DHCP traffic, which uses UDP, communicates on ports 67 and 68. Of the other ports, only 143 is widely used but as the port for IMAP and not related to UDP.

8. D. The slapd_db_recover command can be used to help recover an OpenLDAP database that has become corrupt or otherwise invalid. The remaining options for this question are not valid commands.

9. C. The domain suffix search order can be set through a DHCP option. The option name is domain-search and the values are separated by a comma.

10. A. The directory /var/lib/ldap stores database files related to the OpenLDAP deployment on a given server. The other directories shown are not valid for this purpose.

11. C. The pam_nologin.so module facilitates a scenario whereby non-root logins are prevented when /etc/nologin exists. This module must be specified within the configuration file for a given service. For example, within the sshd PAM configuration file, the following line creates this configuration for ssh:
account required pam_nologin. so

12. D. The LDAP Data Interchange Format (LDIF) is an open format, defined in RFC 2849, which enables import and export of LDAP entries. The file formats TXT and CSV are valid but not for the purpose described. There is no specific file format known as LDAP.

13. C. The pam_unix.so module is used for standard login. The man page for pam_unix.so indicates that it is for “traditional password authentication.” The other modules listed are not standard PAM modules, though there is a similar pam_auth or squid_pam_auth module for Squid.

14. B. The clients section within an interface in radvd.conf enables configuration of specific clients to which route advertisements will be sent. The other options listed for this question are not valid directives in radvd.conf.

15. B. Debug level 64 provides configuration processing debug information. Debug level 1 traces function calls, while level 8 shows connection management. Debug level 0 is no debug.

16. B. The max-lease-time directive, followed by the number of seconds, specifies the amount of time that a given host can have a lease before it is purged. The other options shown are not valid in a dhcpd.conf configuration file.

17. B. The DHCPDISCOVER message being logged is coming from a client. The client is beginning the process of obtaining an IP address from the DHCP server.

18. A. Within nsswitch.conf, the passwd line contains information about authentication. The format is as shown in the correct answer. Local authentication is accomplished using the files keyword for the normal passwd file. There is typically a similar line called shadow, assuming that the server is using shadow passwords. The shadow line follows a similar format.

19. B. The pam_cracklib.so module enforces password strength options. The other files listed are not valid PAM modules.

20. B. The -c option specifies an alternate configuration file for sssd. The -f option sends debug output to a file. There is no -a or -m option for sssd.

21. C. DHCP failover communicates on port 647. DHCP failover is helpful to provide redundancy for this important service. Ports 67 and 68 are used for normal DHCP traffic, while 389 is for LDAP.

22. C. The routers option defines the default gateway for a given DHCP lease. Like other options, routers can be specified at the subnet level or for an individual host. The other options are not valid for the purpose described.

23. C. The slapcat command dumps the slapd database in LDIF format. The other commands are not valid.

24. D. The pam_limits.so module is responsible for enforcement of limits such as those mentioned in the problem as well as several others like the maximum size of files, memory usage, and so on. The other modules listed are not valid.

25. C. The slapindex command generates indexes based on slapd databases. The other commands are not valid.

26. D. There are multiple ways to specify log levels and debugging for slapd, including by keyword, by integer, or as shown in the question, by hex. All of the values shown are valid for loglevel. No debugging is 0, trace is 1, stats logging is 256 or 512 depending on type, and packets sent and received is integer 16 or hex 0x10.

27. D. The -j option enables specification of a line from which the import will be started. It is useful in the scenario described where the import needs to be restarted due to error. The -f option specifies an alternate location for the slapd configuration file. The -q option is quick mode, with less checking, and -l specifies the input file.

28. D. Beginning with OpenLDAP version 2.3, slapd-config is used for configuration of OpenLDAP, as documented at http://www.openldap.org/doc/admin24/slapdconf2.html. The other commands are not valid.

29. B. The changetype add creates a new entry in the LDAP database. The other changetypes are not valid.

30. B. Specifying one -L indicates LDIFv1 format. The next -L turns off comments in the output, and a third -L suppresses the version. The other options are not valid for the described scenario.

31. C. The port for LDAPS or LDAP over SSL is 636. Port 389 is standard, non-SSL LDAP. Port 443 is used for HTTPS, and 3128 is used for Squid proxies.

32. B. The pam_listfiles.so module is used to create scenarios whereby you can create files that control authentication and authorization through the PAM system. The other files are not valid for the scenario described.

33. A. The -n option shows the results without actually making changes to the LDAP database. The other options are not valid for the scenario described.

34. B. The filter (objectClass=*) is used when there is no filter provided for ldapsearch. The other filters shown are not valid with ldapsearch.

35. A. The pam_sss.so module is used for integration of SSSD into the PAM authentication system. The other modules are not valid.

36. B. The ldap_uri option sets the URI of the LDAP server for use with SSSD. The other options are not valid for use in sssd.conf.

37. B. The deny unknown-clients configuration directive will cause the DHCP server to deny addresses when a client requests an address through DHCP. The other options shown are not valid.

Chapter 22: E-Mail Services (Topic 211)
1. A. The postsuper command is used for management of various items with Postfix, including deletion of individual messages from the mail queue. The other commands will not work for the purpose described.

2. C. The /var/spool/postfix directory contains directories and files related to the mail queue for Postfix. The other directories listed are not valid for this scenario.

3. B. PEM format is used for public and private keys with a Postfix TLS configuration. The other methods listed are valid cryptographic algorithms or systems but not for the scenario described.

4. D. The fileinto keyword is used to define the destination for mail that matches one or more conditions within Sieve. The other configuration keywords are not valid.

5. D. The directory /etc/postfix contains files related to the configuration of Postfix on a given server. While the other directories shown are valid names, they are not the default location for Postfix-related configs.

6. B. The file .procmailrc, found in a user’s home directory, is used by Procmail for processing messages on a per-user basis. The other files are not used by Procmail in a default ­configuration.

7. D. The format is local-address: destination-address. Each destination address is separated by a comma. The difference between answers C and D is that the question specifically asked for addresses @example.com, and since the question didn’t specify whether this server was the server for @example.com, the destination addresses needed to be fully qualified.

8. C. The mailq command displays the current mail queue for a Postfix server. The other commands are not valid, though there is popular mail server software named qmail.

9. A. The postqueue command will be used for this purpose, and when given the -f option, it will flush the queue immediately. The other commands and options do not meet the intended purpose for the scenario.

10. B. The postsuper command is used for this purpose, specifically with the -d option. When given the ALL keyword, all messages will be deleted from the queue.

11. A. The newaliases command will rebuild the /etc/aliases database so that changes will be noted by the mail daemon. The other commands shown are not valid.

12. B. The keep action causes the message to be preserved in the mailbox. The other verbs shown are not valid Sieve actions.

13. D. The postcat command shows the contents of a message from the Postfix queue. The other commands shown are not valid.

14. D. The doveadm command is used for this solution. The option called who produces a list of the users who are currently logged in, their PIDs, and their IP addresses. There is no list option for doveadm or dovecot, and likewise there is no users option for the dovecot command.

15. B. The discard keyword is used to specify that a message should be deleted. It is usually followed by the stop keyword in order to indicate that no further processing needs to be done for that message.

16. A. The postqueue -p command and option view the pending queue. The postqueue -f command and option cause the queue to be flushed. The other commands shown are valid but their options are not.

17. C. The redirect action will be used but must be accompanied by the :copy keyword in order to retain a copy of the message. There are no forward or :duplicate keywords in Sieve.

18. B. The :days keyword sets how frequently the vacation auto-responder will reply to a given sender. For example, setting :days 1 means that the same sender will receive a vacation auto-response once a day at most. The other keywords are not valid.

19. C. The qshape command displays information regarding the number and age of the messages in the Postfix incoming and active queues. Other queues can be viewed using the command as well. The other commands shown as options for this question are not valid.

20. A. The doveconf command displays configuration parameters related to Dovecot, including the setting name and its value. The dovecot command is valid, as is the doveadm command. However, the options shown for both of those commands are not valid. There is no doveconfig command.

21. A. There is an implicit keep action if no other action takes precedence or otherwise handles the e-mail within a set of actions. There is a discard action, but it is not the default. There is no action called shred or forward.

22. B. The mynetworks parameter sets the networks or hosts that are allowed to relay through the Postfix server. The other options are not valid. Note that there are parameters related to relaying, such as relayhost, but those are typically used to set the destination for relaying rather than allow relaying through the server.

23. D. The doveadm command, when used with the auth option, tests authentication for a given user. There is a dovecot command, but the command does not have auth or testauth options. Likewise, there is no testauth option to doveadm.

24. D. The m4 command compiles a native Sendmail configuration into the final Sendmail configuration file. A standard redirect is used to send the output to its final destination.

25. A. The postconf command is used for this purpose, and when given the -d option it displays all parameters in the current Postfix configuration. Note that the only other command shown that is valid is postfix, but that command uses -c to specify the configuration directory and not for the purpose described in the scenario for this question.

26. C. The file /var/log/mail.err contains errors related to mail delivery. However, on some systems, mail-related errors may go to a different log such as /var/log/mail.log or /var/log/mail.info or similar.

27. B. The inet_listener directive creates a stanza for a listening port within Dovecot. Additional parameters can be specified relating to the given listener within the inet_listener stanza.

28. A. SMTP uses TCP port 25 by default. Port 110 is POP3, and 143 is IMAP. Port 2525 is not a well-known port.

29. C. The mailq_path parameter contains the path to the mail queue for Postfix. You can use this to diagnose problems with the queue directories. The other parameters shown are not valid in Postfix.

30. D. The EHLO command indicates Extended Hello syntax, and it is followed by the host from which communication has been initiated. Of the other options, the HELO option is valid, but it is not the Extended Hello syntax specified in the question.

31. B. Sieve uses elsif for definition of an alternate condition. The other forms of this keyword are valid for many languages but not for Sieve. There is no alt keyword.

32. B. The :contains keyword looks through an object such as an address to see if there is a matching string within it. The other keywords shown are not valid.

33. A. The process_limit option specifies the maximum login processes for a Dovecot server. The parameter is set on a per-service basis.

34. D. The :domain keyword matches on just the domain portion of an address in Sieve. The other keywords shown are not valid.

35. B. The default port for IMAPS is 993. POP3 uses 110 for unencrypted communication and 995 for encrypted communication. The default port for unencrypted IMAP is 143.

36. A. The Exim configuration file is /etc/exim/exim4.conf by default on Debian, but it may be named as shown for the other options when using other Linux distributions.

37. B. The postscreen_tls_security_level option sets the security level for the postscreen server. This option should be used instead of the postscreen_use_tls and smtpd_use_tls
options.

Chapter 23: System Security (Topic 212)
1. A. The PermitRootLogin directive, set to yes or no, determines whether the root user can log in directly. The other options shown are not valid.

2. B. The file vsftpd.conf contains the configuration for vsftpd. The file can be found in /etc or within a subdirectory such as /etc/vsftpd.

3. B. The PREROUTING chain, part of the nat table, contains rules that are applied as packets arrive. A common use for this chain is to apply redirect rules. Among the other answers, REDIRECT may appear valid, but it is in fact a target and not a chain. The other options shown are not valid.

4. A. The primary configuration file for OpenSSH is /etc/ssh/sshd_config. The other options shown are not valid.

5. C. The iptables-save command creates a file with the currently running iptables rules. The file can then be applied the next time the server is restarted. The other commands shown are not valid.

6. B. The -H option causes Pure FTPd not to resolve host names. The -n option is used for quota enforcement, and the -r option is used to indicate that existing files should not be overwritten. The -z option allows anonymous users to read directories and files that are preceded with a dot.

7. D. The ssh-keygen command generates a public and private key pair that can be used for user authentication between a client and server. The other commands shown are not valid.

8. B. The telnet command can be used for this purpose and, for SMTP, requires the use of a port as shown in the correct answer for this question. There is no smtptest command, and specifying the port by name or not specifying the port will not work.

9. D. The iptables -n option causes iptables not to resolve host names or port names. The -L option lists current rules. There is no -a option.

10. C. The -i option disables uploads by anonymous users. The -a option keeps users in their home directory unless they are a member of a specified group. The -m option prevents anonymous download if the CPU load on the server is above a threshold. The -n option is used for quota enforcement.

11. A. The Port option specifies the port on which the OpenSSH server daemon will listen. Clients will need to specify the port using -p or with colon notation in order to connect to the server. The other options shown are not valid.

12. B. The push directive is used to send a route to clients on connection. In this case, the network and netmask are sent, with 255.255.255.0 being appropriate for a /24. The other options are not valid.

13. B. The nmap command is used for this purpose, and the -sT option performs a TCP Connect to the specified host or network. The other commands are not valid.

14. D. The /etc/fail2ban directory contains configuration files related to fail2ban. The other directories shown are not valid.

15. A. The -i option specifies the identity file or key that will be used for authentication. The server must have a copy of the public key and be configured for key-based authentication in order for the authentication to be successful. The -p option specifies the port. The -k option disables forwarding of GSSAPI credentials and is not related to the described scenario. The -l option specifies the username to use for authentication.

16. B. The ip6tables-save command saves the currently running IPv6 iptables configuration. The other commands shown are not valid. Most of the IPv6 commands related to iptables are of the form ip6tables.

17. B. The PermitEmptyPasswords directive, when set to yes or no, specifies whether empty passwords can be used for authentication. Enabling empty passwords would be a specialized use case and generally not recommended. The other options shown are not valid.

18. C. The -P option sets the policy for a given chain in iptables. In this case, the chain is INPUT and the policy necessary is DROP.

19. B. OpenVPN listens on UDP port 1194 by default. The other combinations are not the valid OpenVPN configuration.

20. B. The Protocol directive specifies the version of the SSH protocol that should be used. Currently, version 2 is recommended. The other options shown are not valid.

21. B. The DROP target silently discards packets that match the rule. An ICMP unreachable message is sent back for REJECT. In general, DROP is preferred in order to reduce the chances of Denial of Service (DoS) or other information-gathering issues.

22. D. The file authorized_keys contains keys that can then be used for authentication when the corresponding private key is sent by the client. The other files are not valid.

23. B. The -m match limit, along with the configuration options shown, creates the scenario described. There will be three log entries per minute. This can be useful to prevent Denial of Service by filling up log files or overwhelming the server I/O while another attack is under way.

24. C. The -X option enables X11 application forwarding through an SSH connection. The -A option is used for authentication agent forwarding, and -F indicates a per-user configuration file. There is no -X11 option.

25. C. The lsof -i command and option can be used for this purpose. A list of processes and ports will be shown and can then be used to determine which actual process is listening on the port. Of the other commands, tcpdump is valid but will not show the information necessary to solve the problem described. The other commands are not valid.

26. A. The INPUT chain is used, and when used with the -A option, it will append a rule to the chain. The -p option specifies the protocol, ICMP in this case, and the -j option specifies the target, ACCEPT, in this case. The -P option specifies a policy and is not used for this scenario.

27. D. The AllowTcpForwarding configuration directive determines whether port forwarding will be allowed through the SSH server. When enabled, clients can forward ports through their SSH connections. The other directives are not valid.

28. B. The INPUT chain will be used, and a rule needs to be appended with -A. The ALL option when specifying protocol means that all protocols will be included in the rule. The -s option specifies the source, which in this case is a single IP address. Finally, the DROP target silently discards packets. There is no BLOCK or DISCARD target, and the ACCEPT target will not block but will accept all traffic.

29. A. A rule will be appended to the INPUT chain with -A. In this case, the protocol should be specified with -p TCP and a destination port of 2222. The source address indicated, 0/0, applies the rule to all hosts. The ACCEPT target will be used.

30. B. Echoing a 1 to the /proc/sys/net/ipv4/ip_forward file enables forwarding of IP packets. This is necessary in order to utilize NAT and for other uses. There is no /proc/sys/net/ipv4/nat file.

31. D. The listen_ipv6 directive is used to indicate that IPv6 will be enabled for vsftpd. The other directives shown are not valid.

32. C. The PubkeyAuthentication directive determines whether key-based authentication can be used with the server. The other directives shown are not valid.

33. A. The logpath directive determines the log file that will be monitored for failures by fail2ban. This file is used as part of a larger configuration for a given jail. The other directives are not valid for fail2ban.

34. D. The ssh-copy-id command sends an identity to a remote server that can then be used for key-based authentication. The other commands shown are not valid.

35. B. The ip6tables command is used for creation and maintenance of a firewall for IPv6. The ip6tables command is similar to the iptables command in form.

36. C. The push directive is used, and it requires the use of dhcp-option, in this case, DNS 192.168.2.1. The other formats and options are not valid.

37. A. The local_enable directive specifies whether users will be able to log in to the server. This option would not be used in cases where the FTP server is anonymous only.

Chapter 24: Practice Test 1
1. B. The /proc filesystem stores information about running processes on the system. The /etc filesystem is used for configuration information, and /dev is used for device information. The /environment filesystem does not exist on a default Linux system.

2. C. The /etc/modprobe.d directory contains information related to the modprobe configuration. This can be overridden with the -C option on the command line.

3. A. The -g option to wall sends the input to the specified group. Answer B will send the output to all users, while answers C and D will not work.

4. B. The SIGTERM signal is the default signal sent with the systemctl kill command.

5. B. The -e option to dmesg displays the time in local time and the delta in a format that is typically easier to work with. The -rel option does not exist. The -f option specifies the logging facility, and -t does not display time at all.

6. B. The init process is typically associated with the initial process ID of 1 to indicate that it is the process from which others are spawned. Killing PID 1 will typically and immediately halt the system.

7. C. The lspci command shows the PCI devices in the system, and the -k option shows the kernel driver being used by the given device. The lsusb command will not accomplish the task requested, and the ls command with -pci will not display the correct information. There is no showpci command.

8. C. The –no-wall option will cause telinit not to send a wall command to logged-in users about the state change. The other options listed in this problem do not exist.

9. A. The class/net hierarchy within /sys contains information on the network configuration for the computer. It is a symlink to the devices hierarchy, where the device will be listed by its address rather than the logical eth0 name.

10. D. A logical location to begin troubleshooting is within the system BIOS to ensure that the drive is being detected by the computer.

11. C. The dbus-monitor program, which requires an X display, can be used to monitor dbus. The other programs and options listed for this question do not exist.

12. A. The udevd service is called systemd-udevd.service within a systemd environment.

13. A. The system can be scheduled to shut down at a certain time, and that time should be entered in 24-hour format, as shown in the answer.

14. C. The -s option changes the signal to be sent from its default of SIGTERM. The new signal must be one of the main signal types such as SIGINT or SIGSTOP.

15. D. The list-unit-files command shows the files available, while –type=service limits those files to the services, in the same way that chkconfig –list returns a list of services.

16. A. The -C option sets the location of the cache to be updated instead of the default /etc/ld.so.cache. The lowercase option, -c, changes the format of the cache, while -v sets verbose mode. The –f option does not exist.

17. C. The -P option to dpkg will purge a package from the system, including the configuration files associated with the package. The apt-cache clean command will clean the package cache but not an individual package, and the apt-get remove command will remove a package but not associated configuration files.

18. C. The deb-src prefix is used to indicate that a given repository contains source packages. The deb prefix in option A would indicate normal packages. The other options are not valid.

19. B. The -U option is used to upgrade a package. Adding -v for verbose and -h for hash marks will print additional information and progress, as requested by the problem.

20. A. The -y or –assumeyes option will do what it says, that is, assume that you will answer yes and therefore not prompt. The other options do not exist.

21. A. The exclude option within /etc/yum.conf is a space-separated list of packages that accepts wildcards and cannot be installed or upgraded. The other options listed in this question do not exist.

22. C. The ldconfig command is used to work with the library cache and the -p option prints the directories and libraries in the cache. The -C option informs ldconfig to use a different cache. The ldd command prints the library dependencies for a given command, but the options given don’t exist for ldd.

23. D. The baseurl option is used to set the URL and must be fully qualified, meaning that it must include the protocol such as http:// or file://.

24. B. The apt-cache dump command will display a listing of the available packages and their respective dependencies. The other commands and options listed in this problem do not exist.

25. A. The /boot directory almost certainly exists but has not been partitioned into its own space. The /boot partition would not be hidden from lsblk if it was indeed a separate partition.

26. B. The /var/cache hierarchy contains cached data for both package management tools. In the case of yum, cached data is stored in /var/cache/yum, and in the case of a Debian-based system, cached data is stored in /var/cache/apt.

27. A. The Master Boot Record (MBR) is the typical location for the bootloader to be stored on a BIOS-based system.

28. D. The / filesystem is the root filesystem. If separate partitions have not been created, the / filesystem will be the beginning of the hierarchy and will contain all other directories in the same partition.

29. A. The –output option configures the location for output of the command instead of STDOUT.

30. C. The tilde key (~) is used as a substitute for a given user’s home directory. The other options shown here will not work for the purpose described.

31. A. The dd command is used for this purpose, and in this case it takes an input file with the if option and an output destination with the of option. The bs option signals that the block size for writing should be 1 megabyte.

32. D. The history command displays history from the current session and can be used for the purpose described. The .bash_history file is written on session close, by default.

33. C. The –boot-directory option will install the boot images into the directory specified. This might be helpful for non-standard installs or at times when you need to mount the boot partition separately. The other options listed in this question do not exist.

34. A. The update-grub command should be executed in order to make changes take effect in the menu and when changes have been made to the GRUB configuration. The other commands listed in this question do not exist.

35. B. The export command is used for this purpose and accepts a name=value pair, as shown in the answer. The other commands are not valid with the exception of the echo command, which will simply echo the argument to the console.

36. C. The HISTFILESIZE option configures the number of commands to keep in the history file. The other variables are not valid within Bash.

37. D. The -b option configures the body numbering format for nl, which by default will not number blank lines. The -a format option will number all lines including blanks. The -a option is not for the nl command, and the -n option configures the numbering format and would require an additional argument in order to be valid.

38. D. The od command is used to create octal output. The cat command will show the file as it exists on disk. The other two commands are not valid.

39. A. The pr command formats text for printing, including the date and page numbers at the top of each page. Adding the -d option causes the output to be double-spaced. The cat command will display output but will not be paginated in such a way. The other two commands are not valid.

40. A. The -n option is used to change the number of lines. Adding the +N after the -n option begins the tail process at the Nth line within the file.

41. C. The -i option causes the unique test to be done while ignoring the case of the element to be matched.

42. C. The awk command shown can be used for this purpose. The -F option sets the field separator, and the OFS option sets the output field separator.

43. C. The -a option is equivalent to the -d and -R options, which preserve links and copy recursively, respectively. The -b option creates a backup, and -f forces the copy.

44. A. When in command mode, typing a number followed by an uppercase G will immediately move the cursor to that line number. The /23 option will search for the number 23 in the file. The i23 option will insert the number 23, and finally ZZ will exit Vi.

45. A. The -d option changes the update interval and can be helpful on a busy system where top may be affecting performance. The -n option sets the number of iterations to run. There is no -t or -f option for top.

46. B. The ps -e command is used to display all processes, while the -o option configures the columns to display.

47. A. The grep command can be used for this purpose. Note the difference between grep -r and grep -ri. The question did not ask for case insensitivity, and therefore the use of -i in option B makes it incorrect.

48. B. The find command will be used for this purpose. Setting the directory from which to begin the find is required, along with the expression, which in this case is files beginning with DB.

49. B. Load average information is gathered from /proc/loadavg, while uptime information is stored on /proc/uptime.

50. C. The -f option will force the umount to occur. The –fake option is essentially a dry run in that it won’t actually unmount a filesystem. The other two options do not exist.

51. C. The -r option will perform an interactive repair. The -f option forces the operation, while -y and -a are both variations of non-interactive repair.

52. D. The /etc/mtab file is updated dynamically as filesystems are mounted and unmounted. The /etc/fstab file is not dynamically updated.

53. B. The -s option displays output in human-readable format. The -p option is used to print the raw grace period. The -h option displays help, and the -f (lowercase) does not exist, though -F (uppercase) would change the report format.

54. B. The -B option changes the format and -T sets the scale to terabytes. The other options do not exist.

55. A. The e2image program can be used to create an image of metadata that can help with drive recovery. The resulting image file can be used with programs like dumpe2fs and debugfs.

56. C. The -c option checks for bad blocks. The -b option sets the block size. There is no -a or -d option.

57. B. The chown command is used for this purpose, and it can be used to set both the user and group for ownership.

58. B. The HISTSIZE value is the current session history. HISTFILESIZE configures the number of lines to keep in the .bash_history.

59. C. The GRUB_RECORDFAIL_TIMEOUT option is used to configure the behavior of the system in the event of a failed boot. Setting the value to -1 will display the GRUB menu and not continue booting. Setting to 0 will cause the menu to not display. Setting to a value greater than or equal to 1 will cause the menu to display for that many seconds.

60. A. The -s option displays a summary, while -h displays it in a human-readable format.

61. D. The -L option tells find to follow symlinks. The -H and -P options are both variations to tell find not to follow symlinks, while the -S option does not exist.

Chapter 25: Practice Test 2
1. A. The /etc/hosts.deny file is part of TCP Wrappers along with /etc/hosts.allow. Both provide a basic mechanism for configuration of access from remote hosts to network services.

2. B. The WHERE clause can be used to limit the rows returned or affected by a SELECT, UPDATE, or DELETE statement. Within a GROUP BY, the HAVING keyword is used.

3. C. The alias command uses the alias name followed by an equals sign followed by the command to be aliased. In this case, because the command to be aliased contains spaces, it needs to be contained in quotation marks.

4. C. Shell scripting syntax uses the format shown, with square brackets around the condition to be tested and double-equals for a string test. Variables are preceded by a dollar sign as shown.

5. A. The export command is necessary so that any variables that are manually defined in your current session become available to child processes. The source command executes the file and can be used for the purpose described, but it requires an additional argument. The let and def commands are not valid.

6. C. The source command is the functional equivalent of a single dot (.). The set command exists, but it is not used for this purpose. The other commands are not valid.

7. A. The syntax for setting the PATH separates the new path with a colon, as shown in the correct option. A primary difference between the correct and incorrect options for this question is in how the actual specified path is shown.

8. A. The correct syntax is as shown. Note that a semicolon is required when the commands are included on one line, as shown in the answer.

9. C. The mail command with -s for the subject is necessary, followed by the e-mail address for the mail. Then input is redirected to the mail command using /etc/hostname.

10. C. The /etc/skel directory contains files that are a skeleton of a user’s home directory when their account is created. The other directories listed do not exist by default.

11. B. The syntax at a minimum sees the UPDATE keyword, followed by the table name, and then followed by the SET keyword.

12. A. The command shown launches speech output for Orca. The other commands contain options that are invalid and thus will not work.

13. D. The Universal Access section, which can be found by typing Universal Access from within an Ubuntu GUI interface, enables configuration of accessibility options.

14. B. The kbdrate command is used for the purpose described and can help with accessibility. The other commands shown are not valid.

15. A. The configuration files can be found in the /etc/lightdm hierarchy or /usr/share/lightdm. The other directory locations do not exist by default.

16. A. The DISPLAY variable controls the destination and screen for displaying GUI applications. Setting this variable facilitates forwarding of X applications over ssh.

17. D. The xwininfo command is used to gather information about windows. The other commands shown are not valid.

18. B. The xhost command is used to control who can make connections for both users and hosts to a given X server. The other commands are not valid.

19. B. The -f option sets the days between expiration and disabled for an account. The -g option is used to set the group ID, while -e is used to set the overall expiration date.

20. A. The getent command can be used for the purpose described, and it will display the aliases on the server by examining the aliases database. The other commands are not valid, and in the case of the mail command shown it will simply attempt to send mail to an address known as aliases.

21. C. The ALL: ALL syntax will cause all hosts to be denied. This means that you must explicitly authorize hosts and networks using /etc/hosts.allow.

22. B. The current at jobs for all users are shown when atq is executed as superuser.

23. A. The tzconfig command can be used on a Debian system to set the time zone. The other commands listed do not exist.

24. C. The -r option to the crontab command removes all cron entries for a given user. The -l option lists cron jobs, while the -e edits the crontab. There is no -d option.

25. A. The -u option specifies the user. The -l option lists the cron jobs and -e edits them. There is no -d or -m option.

26. C. The locale command is used for this purpose, and the -m option displays the available character maps. There is no charmap or mapinfo command.

27. B. Timezone information is found within the /usr/share/zoneinfo hierarchy. The other directories listed do not typically exist by default.

28. A. The userdel command, given no other options, does not delete their home directory. When given the -r option, the command will delete the home directory and mail spool file. There is no -h or -p option for the userdel command.

29. D. The -gid option is used to specify group ownership for the find command. The -group option does exist, but since the question specified that the group had already been deleted, the -gid must be used instead. There is a -user option, but that searches by name and not group ID.

30. B. The groupmod command is used for this purpose, and the -n option followed by the new group name is used to change the name. There is no groupchg command.

31. D. The journalctl command is used to view and parse log file entries on systemd-based systems that maintain logs in a special format. The logger command can be used to create log entries, and the other commands shown do not exist.

32. A. The default location on a Red Hat system is /var/lib/ntp/drift. The other locations shown do not exist by default. Within /etc/ntpd.conf, the location of the drift file can be changed with the driftfile option.

33. A. The -o option, followed by either 1 or 2, enables ntpdate compatibility with older NTP servers. The default, when no -o option is specified, is version 3. The -v option tells ntpdate to be verbose, while the -e option sets the authentication timeout.

34. D. The directory /var/log/journal is used to store journal log files for systemd-based systems. The other directories do not exist by default.

35. C. The -m option sets the mail program to use when mailing logs. It is set to /usr/bin/mail -s by default. There is no -o option and -v is verbose. The -s option to the logrotate command sets the state file to use.

36. A. The -u option configures the output to UTC regardless of the time zone. The -s option sets the time, and there is no -v or -t option.

37. D. The lprm command is used to remove print jobs on a system that uses the lp system for printing. There is no lpdel or rmprint command. There is an rm command, but it’s not used for working with print queues.

38. C. The <<< character combination reads input from STDIN or Standard Input and uses it as the body of the message for the mail command.

39. C. The groupdel command is used to remove a group from a system. There can be no members of the group remaining or the command will fail.

40. C. The lpr syslog facility sends messages from the lp subsystem to syslog. The auth facility is used for security-related messages. The other listed options are not syslog facilities.

41. D. The 255.255.254.0 subnet mask is equivalent to a /23. The 255.255.255.0 subnet mask is a /24. The subnet mask 255.255.255.255 is /32 and 255.255.0.0 is a /16.

42. A. The /etc/hosts file will be examined first, and then a DNS query will be sent based on the configuration shown.

43. D. Standard LDAP traffic is TCP port 389 on the server. TCP port 25 is SMTP, 443 is HTTPS, and 143 is IMAP.

44. C. The -l option to ssh changes the username sent for authentication. This can be useful for scripting scenarios where the @ notation cannot be used. The -v option is verbose mode, and -i is the identity file to use. There is no -u option.

45. D. The -n option disables name resolution for addresses involved in the ping request/reply. The -D option returns a timestamp, while -d sets the SO_DEBUG option. Finally, -f is a flood ping.

46. A. The ifconfig command shows various statistics about the interfaces on a Linux system, including whether the interface is up or down, its packets and bytes, queue length, and other information. The other commands listed do not exist.

47. B. The -6 option causes dig to use IPv6 for communication.

48. B. The current limit is six domains and 256 total characters for the search option in /etc/resolv.conf.

49. C. The -C option shows SOA for each of the DNS name servers listed as authoritative for the domain. The -a option sends an ANY query, while -N sets the number of dots for the domain to be considered absolute. There is no -n option.

50. A. The entire 127.0.0.0/8 range is available for local host addresses. Therefore, an answer would need to be in this range. The proper format for /etc/hosts is IP address followed by name followed by alias, which makes answer A correct.

51. C. The –ignore-errors option tells ifup to continue even if there are otherwise fatal errors. The -h option outputs help. There is no –C or –continue option.

52. C. The -u option unlocks an account that was locked using the -l option. The -w option sets the warn days, and -S prints the status.

53. C. When connecting to an alternate port, you can use the -p option to set the port or use a colon to separate the host from the port.

54. A. If /etc/cron.allow exists, then /etc/cron.deny is ignored and only those users listed in /etc/cron.allow can create cron jobs.

55. B. The mailto configuration option sets the destination for e-mails related to sudo. The other options listed are not valid for sudo.

56. B. The who command displays who is currently logged in and the date and time they logged in. The whois command displays information about domains. The other commands are not valid.

57. C. Port 123 is used for NTP communication by default. Port 161 is SNMP, while Port 139 is NetBIOS and Port 194 is IRC.

58. D. A UDP scan can be initiated with -sU. A scan of -sT is a normal TCP scan, and -sS is a SYN scan. There is no -sP option.

59. C. The ssh-keyscan command can be used to retrieve a host key from a remote ssh host, and it is helpful in scripting scenarios to prevent prompting for a host key on initial connect. There is an ssh-keygen command, but it is used to work with keys that are local.

60. B. The +D option is used to search an entire directory tree for files that are open by processes. The -d option does essentially the same thing, but it does not go into subdirectories. The -f option is typically used in combination with other options to control path name interpretation. The -i option lists files or processes with open ports.

Chapter 26: Practice Test 3
1. A. The –delay option sets the interval between checks of array health. The argument value is in seconds. The other options shown are not valid.

2. A. The –assemble option starts an array that has been previously stopped. The other options are not valid.

3. B. The sfdisk command can be used for this purpose, and when given the –id argument, you can specify the disk and partition on which to operate. The partition type fd is Linux RAID.

4. D. The WWID, or World Wide Identifier, is a unique and system-independent way to identify an individual SCSI device such as that which might be seen when using a SAN or iSCSI device. Of the other options, a /dev/sd device is not persistent across systems or reboots. The other options do not exist.

5. A. The discovery mode is used to discover iSCSI targets. The other options are not valid modes for iscsiadm.

6. C. The vgscan command is used to build the LVM cache file. The cache file keeps a list of current LVM devices. The other commands shown are not valid.

7. B. The sysctl command can be used to view various kernel parameters including the current hostname. That is the primary difference between looking at sysctl and examining /etc/hostname or /etc/hosts. The sysctl command will give the current value, which was specified as a criterion in the question.

8. A. The Banner option within the sshd_config file provides a means by which an administrator can display a message to people logging in with ssh.

9. D. The –prefix option sets the destination prefix or directory into which the resulting compiled code will be installed, typically meaning the binaries from a compile process. The other options shown are not valid in most configure scripts.

10. D. The archive option, invoked with -a, is equivalent to several other options with rsync, such as recursive, preservation of groups and ownership, and others.

11. A. The -D option disables printing of messages to the console. The -E option turns such printing back on. There is no -O or -off option for dmesg.

12. B. The -g option displays multicast information. The -r option displays route information, and -a displays sockets. There is no -m option for netstat.

13. C. The -r option causes the ip command to attempt to resolve IP addresses. The -f option specifies the protocol family. There is no -n or -a option to the ip command.

14. A. The ss command is used, and when given the -o option, timer information is displayed. The netstat -rn command shows route information but not sockets or timing, and ping -f is a flood ping and not related. The ls -l command displays files in a long listing format.

15. D. The dd command typically takes arguments for input file (if) and output file (of) in the format shown.

16. C. All of the addresses shown are in private ranges. The only one with the correct netmask is 255.255.255.0, which is equivalent to 24 masked bits.

17. B. The -b option creates a backup of destination files. The -a option is archive, -c uses a checksum for determining which files to transfer, and -d includes directories but not necessarily recursive copying within the directories.

18. D. The -p option preserves permissions. The -x option extracts, while -z unzips with gzip. The -v option is verbose.

19. C. The !H sequence indicates host unreachable. Network unreachable is !N.

20. A. The -m option specifies how the packet should be marked or tagged. The -a option is audible ping, while -p enables specification of custom padding. There is no -k option.

21. D. The environment variable TAPE can be used to specify the device on which mt will operate. The other environment variables are not used by the mt command.

22. C. The /etc directory and its subdirectories typically contain configuration files that would be necessary in order to re-create the system in a restoration scenario. The /var directory usually contains variable information, while /opt may be used for several other purposes. The /bin directory contains binaries that can usually be reinstalled.

23. B. The -i option tells patch to ignore whitespace. This might be necessary when the patch file doesn’t match exactly what’s needed. The -p option sets the level of directory for the patch, while -e informs patch to interpret as an ed script. There is no -w option for patch.

24. C. The -i option sets the interval between ping requests for iscsiadm. The -a option sets the IP address in ping mode, -o sets a database operation, and there is no -e option.

25. B. The -C option checks the power mode on drives that support the operation. The -a option gets or sets the sector count, -d gets or sets the using_dma option, and the -f option syncs and flushes the buffer cache for the drive on exit.

26. D. The file /proc/swaps contains information on the swap spaces available on a given computer. The other files do not exist by default.

27. B. The rescue target boots the system into rescue mode, from which system recovery can be performed. The other targets listed are not valid.

28. B. The -r option displays a report including CPU time and exit status about the just-completed fsck operation. The -f option forces whatever operation is being requested, -s serializes fsck operations, and -l creates an exclusive flock.

29. C. The allnoconfig target answers no to every question when creating a new config for kernel compilation. Of the other options, only the config target is valid and is used to create a normal config, prompting for answers to portions of the kernel to include.

30. D. The file /proc/meminfo provides a wealth of information about memory usage and utilization. Much of this information is displayed by various commands, but the canonical source for those commands is usually found in this file. Of the other options, only /proc/cpuinfo is valid and that file provides information on the CPU(s) for the computer.

31. B. The -p option shows the parameters for a given module. The other options are not valid for the modinfo command.

32. C. The -k option displays the kernel driver for a given PCI device. The -d option selects devices from the specified vendor. The other options are not valid.

33. D. The udevadm command should be used for this purpose, and the hwdb mode works with the hardware database. The -u option updates the database.

34. A. The systemd-delta command helps to sort out the scenario described by showing overridden, masked, and other file conflicts and ordering. The other commands and options shown are not valid.

35. B. The grub-install command is used for this scenario. SCSI disks are located in /dev/sd* by default, with the first disk being /dev/sda and the second /dev/sdb. Option D is incorrect because it lists both /dev/sdb and the partition number (2).

36. D. The blkid command displays the UUID and other relevant information for appropriate devices. The other commands shown are not valid.

37. C. LUKS encryption is the default mode for the dm-crypt command. Other modes include plain, loopaes, and tcrypt.

38. B. The -b option accepts a parameter of the file containing the El Torito boot image. The boot image must be 1200, 1440, or 2880 KB in size. The other options are not valid with mkisofs.

39. C. An exit code of 64 means that some disks failed the trim process. An exit code of 0 is success, 1 is general failure, and 32 is all failed.

40. D. The correct option is -s for the arp command, and the format is address followed by hardware address. The -d option deletes an entry, and -a displays all entries.

41. B. The txpower option displays available transmit power for the interface. The power option is available, and it lists the power management modes for the interface. The other two are not valid.

42. D. An Xmas scan is available using the -sX mode of nmap. The -sT mode is a TCP connect and -sS is TCP SYN. There is no -sP option.

43. A. The -s option sets the snapshot length, or snaplen, of the capture instead of its default of 65535 bytes. The -l option provides line buffering, -c stops after the indicated count of packets is received, and -d dumps compiled packet-matching code into a format that is readable.

44. B. The -r option reverses the journal, displaying the newest entries first. The -n option shows the most recent N events, -f is follow, and -b tells journalctl to show a message from a specific boot ID.

45. B. The file /etc/lvm/.cache, which is built using the vgscan command, is the default location for LVM devices that have been discovered on the system. The other file locations described are not valid for the purpose described.

46. D. There is no port for ICMP. The protocol itself does not use ports.

47. D. The emergency target can be used in situations where rescue mode cannot recover the system. The other targets are not valid.

48. A. As specified in the question, you need to remove both group and user ownership; therefore, both -g and -o are needed. The other options are not valid, though you can remove individual options from an archive process with –no-g and –no-o, which would be equivalent to removing the -g and -o options from the command.

49. B. The -r option bypasses the routing tables and enables sending packets directly using an interface. The -A option is adaptive ping, while -b enables sending pings to a broadcast address. The -q option is quiet output.

50. A. The traceroute command uses UDP by default and chooses 33434 as its first port. This setting can be configured to another port or to use ICMP but not IGMP.

51. C. The devices at /dev/nst* are non-rewinding tapes; therefore, index 0 would be the first such device. The devices at /dev/st* are normal SCSI tape devices.

52. A. The /var directory typically contains temporary or changeable information. However, mail spool files are usually stored in /var/mail or /var/spool/mail. The /etc directory contains configuration information, and /usr contains binaries and other files that can be reinstalled if necessary. The /mail directory does not exist by default.

53. B. The -b option makes a copy of the original file before patching. This can be particularly useful in a scripted scenario where several files are patched in succession. The -d option causes a change directory prior to patching, while -c tells patch to interpret the patch file as a normal diff file. The -s option causes patch to work in silent mode.

54. D. The -g option shows drive geometry that includes the specified information. The -h option displays help, and the -w option performs a reset of the device. There is no -e option to hdparm.

55. B. The –no-wall option suppresses the warning from being sent to logged-in users. The other options are not valid.

56. C. The -C option can be used to display a progress indicator on the fsck operation. The -f option forces the operation, while -p and -d do not exist.

57. C. The tinyconfig target provides the smallest possible kernel config. The other targets are not valid for the kernel.

58. D. The file /etc/udev/hwdb.bin contains the hardware database for udev, gathered from information in /usr/lib/udev/hwdb.d/ and /etc/udev/hwdb.d/.

59. B. The –diff option displays differences among overridden files with systemd-delta. The other options shown are not valid for use with systemd-delta.

60. B. The -U option enables specification of the UUID for a given mount. The -t option specifies the filesystem type, while -i keeps the mount internal-only and does not call the filesystem helper command. There is no -u option to mount.

Chapter 27: Practice Test 4
1. C. The notify directive, set to yes or no, specifies whether slave servers will be notified of changes to the zone. The other options are not valid.

2. A. The -b option enables specification of the key size. The -a option specifies the algorithm. The -f option sets the flag in the key/dnskey record. There is typically no -e option, but it may tie into a large exponent on certain versions of Linux.

3. B. The -q option suppresses output entirely, thereby making the command print nothing on success. The exit code of 0 for success is returned, however, so the command could still be used in a scripted scenario. The -f option specifies the format of the zone. The -s option has no effect for named-checkzone, and there is no -p option.

4. B. The class of record for most BIND zones is IN, meaning an Internet class. The other options are not valid classes.

5. C. The rndc command listens on port 953 by default. Port 53 is used for DNS but not rndc. Port 530 is RPC and port 1053 is not one of the defined well-known ports.

6. C. Start of authority records are known as SOA records. NS records are name server, and A is a normal address record. IN is the class for the record and not directly related to the question being asked.

7. A. The @ symbol can be used as a means to set the server for the dig command query. The other options shown are not valid.

8. D. The forwarders directive is a list of addresses to which requests will be forwarded from the server. The other options are not valid.

9. A. The query-source directive sets the IP address from which queries will appear to originate. This is useful in multi-homed scenarios where the server may not correctly choose which interface to use. The other options are not valid.

10. A. The -D option dumps the zone file in canonical format. The other options are not valid for this purpose.

11. B. The -t option, followed by the directory, tells named-checkconf to read included files relative to the specified directory.

12. A. The -B option specifies that the program should use bcrypt for passwords. The -C option sets the computing time used for bcrypt. The -b option sets batch mode, and the -m option specifies md5 for the passwords.

13. C. The ServerTokens directive affects how the version number, or even whether the version number, is returned on server-generated documents. The other directives shown are not valid.

14. D. The file httpd.conf is the primary configuration file for Apache2 servers. It is typical for httpd.conf to include one or several other files and directories that contain further configuration information. The httpd.conf file is typically located within the /etc/ hierarchy, though its exact subdirectory varies greatly depending on the distribution of Linux.

15. B. The http_port directive sets the port on which Squid listens for connections. By default, Squid listens on port 3128. The other options shown are not valid.

16. B. The SSLCertificateFile directive sets the location of the public key file for an SSL hosting scenario. The SSLCertificateKeyFile sets the location of the private key. The other directives are not valid.

17. C. The SSLCipherSuite directive enables the selection of cryptographic ciphers available on a server. This can be quite helpful for limiting the ciphers to ones that are believed to be secure at any given moment.

18. C. The format is GroupName: name1 name2 name3, thereby making option C the correct answer.

19. A. The %b sequence is used to log the number of bytes including the HTTP header. The %B sequence logs the number of bytes excluding the HTTP header. Log sequences are preceded with a percent sign, thus making the other options incorrect.

20. C. The -newca option begins the process of creating a new certificate authority through the ca.pl script, which is a helper for the openssl commands related to certificate generation and management.

21. C. Files related to SSL are typically stored in either /etc/ssl (or a subdirectory therein) or within the /etc/pki hierarchy. There is no /etc/private or /usr/share/ssl directory.

22. D. The nmbd daemon listens on UDP port 137. Ports 139 and 445 are used by the smbd daemon, and port 143 is IMAP and not related to Samba.

23. A. The force-election message type, sent to nmbd, forces a browse master election. The other message types are not valid with smbcontrol.

24. B. The ads mode enables integration within an Active Directory environment. The rpc mode is available for remote procedure call environments. The other two modes are not valid.

25. C. The @ character is used to specify an NIS netgroup to use an exported NFS filesystem. The other syntax examples shown are not valid.

26. A. Credentials are included as an option. Options are specified with -o. The username and password can be specified as shown. There is no credentials command-line argument.

27. C. The security level of domain is used for Active Directory–based domain security mode. A trust is established between the domain controller and the Samba server in this scenario.

28. A. The -a option displays the hostname or IP address along with the mounted directory for NFS exports. The -d option displays only the directory. There is no -b or -c option.

29. B. The smbstatus command is used for this purpose. When given the -S option, a list of shares is displayed. The other commands shown are not valid.

30. B. If a user already exists when smbpasswd receives the -a option, the user’s password is simply changed to the new password.

31. B. The port can be set with -p. It’s worth noting that attempting to run Samba on a non-standard port will likely cause problems for devices that cannot specify a custom port for the share. The -d option sets the debug level, while the other options are not valid.

32. D. The fixed-address directive reserves the specified IP address for the given host in DHCP. When that host asks for an IP address, it will receive the specified address. The other options are not valid in a dhcpd.conf configuration file.

33. A. The ldapadd command requires that the OpenLDAP server be online when adding entries. Slapadd does not have this requirement. Both work on local databases.

34. C. The IgnoreIfMissing option within an interface section of radvd.conf changes the behavior of radvd when the given interface does not exist at startup. The other options shown are not valid for radvd.

35. B. The default-lease-time option, followed by the number of seconds for the lease, is used to specify the time that a client can have a lease before asking for a new lease. The other options are not valid.

36. C. The file /etc/nsswitch.conf contains information for Name Service Switch (NSS). The format is as shown in the correct answer. Local files are known as files, and LDAP is known as ldap within the /etc/nsswitch.conf file.

37. C. The [sssd] section defines general parameters for use with the SSSD system. Sections are noted with brackets, as in the answer shown.

38. A. The file limits.conf, located in /etc or /etc/security, provides basic configuration related to the pam_limits.so module. Other related files may also be found in /etc/
security/limits.d on certain distributions.

39. B. The -l option enables specification of a file to which output will be written rather than to STDOUT. The -f option enables the command to point to a different slapd configuration file. The -d option specifies debug and -o enables specification of extended options.

40. B. The modify changetype specifies that an entry will be changed. The other changetypes are not valid.

41. A. The mail attribute resides in inetOrgPerson. Other attributes in inetOrgPerson include homePhone, gn (givenName), and others. Of the other options, only organization is a valid objectClass.

42. D. The gt operator is used to test for greater-than conditions with Sieve. The ge operator tests whether a value is greater than or equal to. The other operators are not used with Sieve.

43. B. The /etc/dovecot directory is used for configuration files related to the Dovecot e-mail daemon. The other directories are not used by default for Dovecot.

44. B. The sendmail command to view the queue uses the -bp option. For mail servers like Postfix, there are emulation commands like sendmail -bp that are available for compatibility purposes.

45. C. The postsuper command is used for this purpose. When given the -d ALL argument, all messages will be deleted. However, because the question specified only the deferred queue, then the keyword deferred is added in order to limit the scope of the deletion.

46. D. The -b option causes postcat to display only the body of the message rather than the envelope (-e) and header (-h), which are the default (-beh) for the command. There is no -m option.

47. B. An if statement will perform a conditional test with Sieve. In this case, the size test is needed and will use the :over structure for comparison. The messagesize and message will not work, but it’s worth noting that the greater-than sign can be used with Sieve.

48. B. The doveadm command is used, specifically with the pw argument. The command will then prompt for a password (twice) and display the resulting encrypted password as output.

49. A. The message_size_limit parameter is used to set the default maximum message size for any single message delivered by or to a Postfix server. The default is 10,240,000 bytes.

50. C. The :all address-part is the entire Internet address, and it is the default when no other address-part has been specified. The other options are not valid address-parts.

51. A. The RCPT TO portion of the SMTP conversation is where the destination address is specified. The other options shown are not part of the SMTP conversation for mail delivery.

52. D. The REDIRECT target is used for creation of a redirection within iptables. It is typically used within the PREROUTING chain. The other targets are not valid.

53. A. The -T option limits bandwidth for authenticated users. The -t option does the same but for anonymous users. The -B option starts Pure-FTPd in the background, and -b indicates that Pure-FTPd will ignore the RFC standard in order to work with FTP clients that don’t adhere to the standard.

54. B. The nc command can be used for this purpose and requires that a port be specified, which is 80 in this case. The other formats for the nc command will not work.

55. C. The -F option flushes or clears rules out of a given iptables chain. The option is useful at the beginning of an iptables script in order to clear existing rules in preparation for a new ruleset. The -P option sets the policy for the chain.

56. A. The AllowUsers directive is used to specify users who will be allowed to log in to the server. The other options shown are not valid.

57. B. Echoing 1 to /proc/sys/net/ipv4/conf/all/rp_filter prevents packets from exiting on a different interface than the one on which they arrived. The rp in rp_filter is an abbreviation for reverse path.

58. D. The -L option sets up local port forwarding, and it is therefore required for this scenario. It is followed by the local port and then the host/port to which connections will be forwarded. The other options are invalid for the purpose described in this scenario. The -p option connects on a specific port but does not create a port forward.

59. B. The file /etc/services contains port-number-to-name translation for a given server. The file contains well-known ports and can be customized on a per-server basis.

60. A. The –log-prefix option specifies the string that will be prepended when a log entry is created by iptables. The other options shown are not valid for use with iptables.

CopyAdd Highlight Add Note
